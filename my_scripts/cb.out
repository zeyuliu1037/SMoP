lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=2 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 2324.05it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2757.04it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2960.77it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 1536
prompt_encoder.router.0.weight 1536
trainable params: 3072 || all params: 222885120 || trainable%: 0.0013782885102424066
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:02<00:13,  2.27s/it]Train:  29%|████████████████▌                                         | 2/7 [00:02<00:05,  1.09s/it]Train:  43%|████████████████████████▊                                 | 3/7 [00:02<00:02,  1.47it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:03<00:01,  1.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:03<00:00,  2.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:03<00:00,  2.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.80it/s]                                                                                                    3.98 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.72it/s]                                                                                                    tensor([10, 42], device='cuda:0')
Epoch 1 | Train loss: 0.11244 | Validation loss: 0.05773 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.25it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.79it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 87.5
tensor([20, 92], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.82it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.22it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.13 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 2 | Train loss: 0.10268 | Validation loss: 0.04286 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.25it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.79it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.56it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.44it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.67it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.11 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 3 | Train loss: 0.09404 | Validation loss: 0.03873 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.26it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.79it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.73it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.55it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.43it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.73it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.75it/s]                                                                                                    2.07 seconds
tensor([ 36, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 4 | Train loss: 0.08723 | Validation loss: 0.05786 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.36it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.18 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 5 | Train loss: 0.08989 | Validation loss: 0.03761 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.27it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.80it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.84it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.08 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.10616 | Validation loss: 0.03896 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.86it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:00,  4.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.20it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.04 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.08570 | Validation loss: 0.03647 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.24it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.52it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.96it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.39it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.73it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.62it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.51it/s]                                                                                                    2.14 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.07131 | Validation loss: 0.03825 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.23 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.07378 | Validation loss: 0.03801 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.21it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.08it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.20 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.07511 | Validation loss: 0.03292 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.24it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.78it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.37it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.49it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.77it/s]                                                                                                    2.08 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.08047 | Validation loss: 0.03304 | Validation acc: 100.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.92it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.10 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.06719 | Validation loss: 0.03321 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.09it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.21 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.08304 | Validation loss: 0.03139 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.24it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.69it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.63it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.56it/s]                                                                                                    2.12 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.06981 | Validation loss: 0.02975 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.77it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.60it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.16 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.07803 | Validation loss: 0.03103 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.67it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.18 seconds
tensor([173,  51], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([50,  2], device='cuda:0')
Epoch 16 | Train loss: 0.06167 | Validation loss: 0.03212 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.65it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.66it/s]                                                                                                    2.18 seconds
tensor([177,  47], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 17 | Train loss: 0.06592 | Validation loss: 0.03582 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.65it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.68it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.58it/s]                                                                                                    2.08 seconds
tensor([204,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 18 | Train loss: 0.06988 | Validation loss: 0.02852 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.76it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.28it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.75it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.56it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.47it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.12 seconds
tensor([201,  23], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 19 | Train loss: 0.06655 | Validation loss: 0.02992 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.70it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.44it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.75it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.74it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.12 seconds
tensor([207,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 20 | Train loss: 0.07111 | Validation loss: 0.02822 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.24it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.16it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  4.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.61it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  3.46it/s]                                                                                                    2.03 seconds
tensor([206,  18], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 21 | Train loss: 0.06910 | Validation loss: 0.02584 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.76it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.15it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.87it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.57it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.52it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.17 seconds
tensor([203,  21], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 22 | Train loss: 0.06741 | Validation loss: 0.03092 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.27it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.66it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.76it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.55it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.13 seconds
tensor([196,  28], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.24it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 23 | Train loss: 0.06545 | Validation loss: 0.03014 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.37it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.31it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.13 seconds
tensor([204,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 24 | Train loss: 0.06250 | Validation loss: 0.03215 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.40it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.97it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.60it/s]                                                                                                    2.10 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 25 | Train loss: 0.04610 | Validation loss: 0.02735 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.69it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.19 seconds
tensor([201,  23], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 26 | Train loss: 0.05875 | Validation loss: 0.02703 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.39it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.71it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.11 seconds
tensor([202,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 27 | Train loss: 0.05631 | Validation loss: 0.02919 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.64it/s]                                                                                                    2.12 seconds
tensor([202,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 28 | Train loss: 0.06063 | Validation loss: 0.02975 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.77it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.38it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.21 seconds
tensor([207,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 29 | Train loss: 0.04904 | Validation loss: 0.02668 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.65it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.82it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.53it/s]                                                                                                    2.09 seconds
tensor([202,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 30 | Train loss: 0.05510 | Validation loss: 0.02598 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.25it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.92it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:00<00:00,  4.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.80it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.04 seconds
tensor([210,  14], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 31 | Train loss: 0.05098 | Validation loss: 0.02526 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.75it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.93it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.65it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.64it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.48it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.14 seconds
tensor([204,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 32 | Train loss: 0.05335 | Validation loss: 0.02746 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.45it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.81it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.43it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.71it/s]                                                                                                    2.07 seconds
tensor([198,  26], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 33 | Train loss: 0.05431 | Validation loss: 0.02970 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.57it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.49it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.62it/s]                                                                                                    2.15 seconds
tensor([196,  28], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 34 | Train loss: 0.05693 | Validation loss: 0.02710 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.80it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.13it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.33it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.57it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.21 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 35 | Train loss: 0.05790 | Validation loss: 0.02903 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.16it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.81it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.64it/s]                                                                                                    2.10 seconds
tensor([200,  24], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 36 | Train loss: 0.05662 | Validation loss: 0.02655 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.84it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.20 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 37 | Train loss: 0.05017 | Validation loss: 0.02588 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.37it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.78it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.74it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.55it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.11 seconds
tensor([210,  14], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 38 | Train loss: 0.04985 | Validation loss: 0.02300 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.67it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.47it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.12 seconds
tensor([207,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 39 | Train loss: 0.06068 | Validation loss: 0.02354 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.75it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.60it/s]                                                                                                    2.12 seconds
tensor([205,  19], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 40 | Train loss: 0.05382 | Validation loss: 0.02333 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.46it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.01it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.20 seconds
tensor([210,  14], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 41 | Train loss: 0.05174 | Validation loss: 0.02323 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.78it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.62it/s]                                                                                                    2.11 seconds
tensor([210,  14], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 42 | Train loss: 0.04939 | Validation loss: 0.02347 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.40it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.36it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.51it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.16 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 43 | Train loss: 0.05186 | Validation loss: 0.02323 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.22it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.70it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.01it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.17 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 44 | Train loss: 0.05360 | Validation loss: 0.02346 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.18it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.26it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.63it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.18 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 45 | Train loss: 0.04945 | Validation loss: 0.02414 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.86it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.22 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 46 | Train loss: 0.04671 | Validation loss: 0.02327 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.36it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.24 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 47 | Train loss: 0.05092 | Validation loss: 0.02289 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.75it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.77it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.17 seconds
tensor([204,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 48 | Train loss: 0.05170 | Validation loss: 0.02339 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.97it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.23 seconds
tensor([207,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 49 | Train loss: 0.04761 | Validation loss: 0.02346 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.97it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.14it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.22it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.19 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 50 | Train loss: 0.05362 | Validation loss: 0.02340 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=2 perturb_router=True topk=1 random_seed=42
Test result | Loss : 92.9 | Score : 87.5
Took 2.30 minutes for training
Took 2.18 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=4 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3052.15it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2749.95it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2945.18it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 3072
prompt_encoder.router.0.weight 3072
trainable params: 6144 || all params: 222888192 || trainable%: 0.002756539027424118
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.30s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.44it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:02,  1.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.43it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.80it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.18it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.91 seconds
tensor([ 55,  25, 119,  25], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 2,  0, 50,  0], device='cuda:0')
Epoch 1 | Train loss: 0.12363 | Validation loss: 0.04354 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.52it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.90it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 85.7
tensor([  0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.18 seconds
tensor([ 22,  12, 186,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0, 52,  0], device='cuda:0')
Epoch 2 | Train loss: 0.09010 | Validation loss: 0.29532 | Validation acc: 57.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.16it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.52it/s]                                                                                                    2.18 seconds
tensor([  9,  11,  80, 124], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 3 | Train loss: 0.10722 | Validation loss: 0.05101 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.44it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.72it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.58it/s]                                                                                                    2.09 seconds
tensor([ 21,  15,   5, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 4 | Train loss: 0.08471 | Validation loss: 0.03319 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.49it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.88it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.85it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.45it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]                                                                                                    2.17 seconds
tensor([ 29,   8,   6, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 5 | Train loss: 0.08716 | Validation loss: 0.03698 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.95it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.50it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.39it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.19 seconds
tensor([ 15,   9,  19, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.08196 | Validation loss: 0.03506 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.97it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.60it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.52it/s]                                                                                                    2.13 seconds
tensor([  8,   8,  14, 194], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.08537 | Validation loss: 0.03546 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.16it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.19it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.18 seconds
tensor([  8,  10,  22, 184], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.08869 | Validation loss: 0.03552 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.47it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.92it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.14 seconds
tensor([ 11,   6,  12, 195], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.09940 | Validation loss: 0.03798 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.02it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.29it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.71it/s]                                                                                                    2.16 seconds
tensor([ 11,   9,  10, 194], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.07348 | Validation loss: 0.03563 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.14it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.19 seconds
tensor([  8,   7,  22, 187], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07340 | Validation loss: 0.03340 | Validation acc: 100.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.99it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.25 seconds
tensor([  8,   9,  11, 196], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.08645 | Validation loss: 0.03437 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.85it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.23 seconds
tensor([ 15,  11,  19, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.07153 | Validation loss: 0.03700 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.44it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.98it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.08it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.20 seconds
tensor([ 10,  10,   9, 195], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.07251 | Validation loss: 0.03453 | Validation acc: 100.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=4 perturb_router=True topk=1 random_seed=42
Test result | Loss : 85.7 | Score : 85.7
Took 0.63 minutes for training
Took 2.23 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3115.74it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2755.99it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2970.24it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 7680
prompt_encoder.router.0.weight 7680
trainable params: 15360 || all params: 222897408 || trainable%: 0.006891062636313833
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.18s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.41it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.69it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.12it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.91 seconds
tensor([19,  9, 13, 55, 86, 20,  2, 11,  2,  7], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.12864 | Validation loss: 0.08369 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.25it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 85.7
tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.50it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.56it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.63it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.82it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.08 seconds
tensor([ 33,  11,   1,  24, 127,   4,   3,  18,   0,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.10025 | Validation loss: 0.17865 | Validation acc: 69.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.95it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.08it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.85it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.15 seconds
tensor([ 24,  19,  12,  15, 131,   3,   8,   9,   0,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.10584 | Validation loss: 0.04069 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.75it/s]                                                                                                    Updating result due to higher validation score
Epoch 3 test result: 87.5
tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.92it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.49it/s]                                                                                                    2.17 seconds
tensor([19, 23,  5, 54, 96, 12,  6,  5,  0,  4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.09492 | Validation loss: 0.04015 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.75it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.76it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([  0,  24,   4, 102,  21,  55,   9,   5,   0,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 14,  0, 38,  0,  0,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.08913 | Validation loss: 0.03996 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([ 0,  0,  0, 34,  0, 78,  0,  0,  0,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.14it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.79it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:00,  4.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  4.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  3.35it/s]                                                                                                    1.99 seconds
tensor([  1,  14,   5,  67,   3, 120,   8,   3,   0,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.09135 | Validation loss: 0.03894 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([  0,   0,   0,   0,   0, 112,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.63it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.16it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.23 seconds
tensor([  0,  26,   0,  33,   2, 157,   2,   3,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.07761 | Validation loss: 0.03727 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([  0,   0,   0,   0,   0, 112,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.13it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.88it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.82it/s]                                                                                                    2.05 seconds
tensor([  0,  24,   2,  43,   6, 145,   2,   1,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.08226 | Validation loss: 0.03312 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.75it/s]                                                                                                    tensor([  0,   0,   0,   0,   0, 112,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.95it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.60it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.22it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.55it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.48it/s]                                                                                                    2.12 seconds
tensor([  1,  21,   2,  38,   2, 146,   7,   4,   2,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.07286 | Validation loss: 0.07048 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.13it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.11 seconds
tensor([  0,  20,   2,  32,   2, 138,   6,   2,   0,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.08599 | Validation loss: 0.06104 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.58it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  4.00it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.10 seconds
tensor([  0,   8,   0,   4,   0,  71,   1,   1,   2, 137], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.24it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07603 | Validation loss: 0.05170 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.77it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.08it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.56it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.02it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.23 seconds
tensor([  1,  11,   0,   5,   0,  78,   2,   0,   1, 126], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.08105 | Validation loss: 0.04291 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.17it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.13it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.26 seconds
tensor([  0,  16,   0,   9,   0,  80,   1,   0,   1, 117], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.07071 | Validation loss: 0.03858 | Validation acc: 96.2
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.90it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.21 seconds
tensor([  0,   9,   0,   7,   0,  90,   1,   1,   1, 115], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.07229 | Validation loss: 0.03481 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.14it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.84it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.06it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.51it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]                                                                                                    2.21 seconds
tensor([  0,  12,   2,   8,   1,  69,   0,   4,   2, 126], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.06515 | Validation loss: 0.03420 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.24it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.29it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.88it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.04it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.21 seconds
tensor([  0,   8,   0,   8,   0,  81,   2,   1,   1, 123], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.07066 | Validation loss: 0.03259 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.87it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.30it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.24 seconds
tensor([  0,  11,   0,  13,   0,  53,   2,   0,   1, 144], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.07321 | Validation loss: 0.03602 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.33it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  4.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.13 seconds
tensor([  0,  14,   0,  18,   0,  59,   1,   0,   1, 131], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.05849 | Validation loss: 0.03158 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  4.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.86it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.59it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.14 seconds
tensor([  0,  11,   0,   9,   2,  56,   1,   1,   3, 141], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.06203 | Validation loss: 0.03775 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.40it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.22 seconds
tensor([  1,   9,   1,   8,   0,  44,   1,   1,   1, 158], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.07260 | Validation loss: 0.03165 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.14it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.19it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.16 seconds
tensor([  3,   9,   0,   1,   0,  18,   5,  25,   2, 161], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.06649 | Validation loss: 0.03478 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.15it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.19it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.60it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.08it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.13 seconds
tensor([  0,   8,   0,   1,   0,  10,   0,  38,   2, 165], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.06343 | Validation loss: 0.04255 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.77it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.58it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.82it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.61it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.09it/s]                                                                                                    2.19 seconds
tensor([  0,  14,   0,   1,   0,   5,   2,  44,   0, 158], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.05428 | Validation loss: 0.05084 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.80it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.65it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.47it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.14 seconds
tensor([  0,  13,   0,   0,   0,  14,   2,  25,   1, 169], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.05600 | Validation loss: 0.03431 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.24 seconds
tensor([  0,  16,   0,   1,   1,  11,   0,  22,   4, 169], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.05407 | Validation loss: 0.03508 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.16it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.84it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.26it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.22 seconds
tensor([  0,  14,   2,   0,   0,  15,   2,  21,   2, 168], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.04867 | Validation loss: 0.04005 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.16it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.19it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.16 seconds
tensor([  0,  12,   1,   0,   0,  22,   0,  20,   3, 166], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.05876 | Validation loss: 0.04007 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.69it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.75it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.06 seconds
tensor([  0,  10,   0,   1,   1,  11,   2,  27,   4, 168], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.06388 | Validation loss: 0.03839 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Test result | Loss : 94.6 | Score : 87.5
Took 1.30 minutes for training
Took 2.19 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3048.63it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2739.10it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2939.39it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 15360
trainable params: 30720 || all params: 222912768 || trainable%: 0.01378117560318483
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.19s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.56it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.55it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.90it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.96it/s]                                                                                                    2.90 seconds
tensor([ 7,  2,  0,  1,  2, 74,  1,  1, 47, 62,  5,  6,  2, 12,  0,  0,  0,  1,
         1,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 16, 36,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.11124 | Validation loss: 0.04567 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.25it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.77it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 85.7
tensor([ 0,  0,  0,  0,  0, 32, 80,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.84it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.37it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.82it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.14it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.55it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.06 seconds
tensor([  0,   0,   2,   0,   0, 109,  94,   0,   3,   9,   0,   1,   0,   0,
          6,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 16, 36,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.09895 | Validation loss: 0.03901 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.74it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 32, 80,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.42it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.16 seconds
tensor([  0,   0,   4,   0,   0, 108,  92,   0,   1,  10,   0,   1,   0,   0,
          8,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.08721 | Validation loss: 0.04032 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.14it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.84it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.99it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.86it/s]                                                                                                    2.09 seconds
tensor([  0,   2,   5,   0,   0, 165,  39,   0,   1,   8,   0,   0,   0,   0,
          4,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.08415 | Validation loss: 0.03578 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.73it/s]                                                                                                    tensor([  0,   0,   0,   0,   0, 112,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:04,  1.45it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.34it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.82it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.98it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.55it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.35 seconds
tensor([  0,   1,   5,   0,   0, 157,   4,   0,   2,  40,   0,   0,   0,   0,
          5,   0,   9,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.11040 | Validation loss: 0.06150 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.95it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.82it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.60it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.83it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  3.40it/s]                                                                                                    2.03 seconds
tensor([ 0,  0,  0,  0,  0, 90,  1,  0,  0, 79,  0,  0,  0,  0,  1,  0, 53,  0,
         0,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.09009 | Validation loss: 0.06855 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.47it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.48it/s]                                                                                                    2.15 seconds
tensor([  0,   0,   1,   0,   0,  75,   2,   0,   0, 110,   0,   0,   0,   0,
          0,   0,  36,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.10883 | Validation loss: 0.08496 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.23it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.75it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.56it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.62it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.17 seconds
tensor([  0,   0,   0,   0,   0,  79,   3,   0,   0, 111,   0,   0,   0,   0,
          0,   0,  31,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.09845 | Validation loss: 0.04898 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.21it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.27 seconds
tensor([  0,   0,   0,   0,   0,  93,   2,   0,   2, 106,   0,   0,   0,   0,
          1,   0,  20,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.09067 | Validation loss: 0.04700 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.96it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.51it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.58it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.17 seconds
tensor([  0,   0,   4,   0,   5,  75,   2,   0,   0, 103,   0,   0,   3,   0,
          2,   0,  30,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.08703 | Validation loss: 0.04659 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.66it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.83it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.64it/s]                                                                                                    2.13 seconds
tensor([  0,   0,   2,   0,   8,  80,   4,   0,   0, 102,   0,   0,   4,   0,
          3,   0,  21,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.08833 | Validation loss: 0.03931 | Validation acc: 92.3
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:04,  1.45it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.73it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.47 seconds
tensor([  0,   0,   0,   0,   6,  69,   3,   0,   0, 122,   0,   0,   1,   0,
          1,   0,  22,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.07455 | Validation loss: 0.04444 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.39it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.19 seconds
tensor([  0,   0,   2,   0,   5,  60,   3,   0,   0, 116,   0,   0,   2,   0,
          2,   0,  34,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.08542 | Validation loss: 0.04131 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  4.18it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.69it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.12 seconds
tensor([  0,   0,   1,   0,  11,  49,   3,   0,   0, 120,   0,   0,   6,   0,
          2,   0,  32,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.08222 | Validation loss: 0.04078 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 87.5 | Score : 85.7
Took 0.64 minutes for training
Took 2.23 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=6 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3016.06it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2712.53it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2939.50it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 4608
prompt_encoder.router.0.weight 1536
trainable params: 6144 || all params: 222888192 || trainable%: 0.002756539027424118
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.24s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.43it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.77it/s]                                                                                                    3.10 seconds
tensor([189,  35], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 1 | Train loss: 0.13454 | Validation loss: 0.05049 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.49it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.87it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 87.5
tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.66it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.52it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.17 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 2 | Train loss: 0.09973 | Validation loss: 0.03957 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.47it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.40it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.55it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.19 seconds
tensor([203,  21], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 3 | Train loss: 0.08268 | Validation loss: 0.03669 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.47it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.40it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.76it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.11it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.52it/s]                                                                                                    2.13 seconds
tensor([213,  11], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 4 | Train loss: 0.07947 | Validation loss: 0.03281 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.50it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.34it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.92it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.57it/s]                                                                                                    2.14 seconds
tensor([205,  19], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 5 | Train loss: 0.07589 | Validation loss: 0.03371 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.66it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.31 seconds
tensor([206,  18], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 6 | Train loss: 0.08394 | Validation loss: 0.03145 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.43it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.83it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.37it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.36it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.98it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.09it/s]                                                                                                    2.21 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 7 | Train loss: 0.07083 | Validation loss: 0.02822 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.44it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.34it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.34it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.86it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.36it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.20 seconds
tensor([199,  25], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.06886 | Validation loss: 0.07264 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.85it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.47it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.57it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.16 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.09596 | Validation loss: 0.03619 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.56it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.72it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.92it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.55it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.95it/s]                                                                                                    2.10 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.07885 | Validation loss: 0.03545 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.21it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.53it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  3.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.50it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.57it/s]                                                                                                    2.13 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07226 | Validation loss: 0.03253 | Validation acc: 96.2
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.88it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.18it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.23 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.07388 | Validation loss: 0.03210 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.41it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.88it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.20 seconds
tensor([ 25, 199], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.07096 | Validation loss: 0.03026 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.22it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.03it/s]                                                                                                    2.45 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.05086 | Validation loss: 0.02338 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.46it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.82it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.93it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.12it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.24 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.05870 | Validation loss: 0.02414 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.20it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.90it/s]                                                                                                    2.47 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.05239 | Validation loss: 0.04240 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.08it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.87it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.05763 | Validation loss: 0.03361 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.19it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.79it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.02it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.26 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.04173 | Validation loss: 0.03327 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  3.00it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.65it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.97it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.02it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.36it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.63it/s]                                                                                                    2.10 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.04852 | Validation loss: 0.02323 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.46it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.91it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.53it/s]                                                                                                    2.16 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.04480 | Validation loss: 0.02096 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.41it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.81it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.56it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.09it/s]                                                                                                    2.21 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.06444 | Validation loss: 0.04522 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.09it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.52it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.80it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.16 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.04162 | Validation loss: 0.02812 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.46it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.56it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.59it/s]                                                                                                    2.12 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.03163 | Validation loss: 0.02128 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.73it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.77it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.13 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.04013 | Validation loss: 0.01637 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.77it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.81it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.96it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.30 seconds
tensor([ 26, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.03667 | Validation loss: 0.01822 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.13it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.65it/s]                                                                                                    2.17 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.03526 | Validation loss: 0.02752 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.80it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.02it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.25 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.04444 | Validation loss: 0.01622 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.44it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.83it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.99it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.45it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.18 seconds
tensor([ 11, 213], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.03586 | Validation loss: 0.03159 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.55it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.59it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.99it/s]                                                                                                    2.23 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.03972 | Validation loss: 0.01403 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.20it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.85it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.23 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.03145 | Validation loss: 0.01681 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.57it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.62it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.16 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.03527 | Validation loss: 0.03020 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.75it/s]                                                                                                    2.16 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 32 | Train loss: 0.03451 | Validation loss: 0.01820 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.09it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.71it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.11 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 33 | Train loss: 0.03136 | Validation loss: 0.02172 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.76it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.93it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.69it/s]                                                                                                    2.08 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 34 | Train loss: 0.02544 | Validation loss: 0.02139 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.63it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.58it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.17 seconds
tensor([ 26, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 35 | Train loss: 0.03567 | Validation loss: 0.03332 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.90it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.55it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.03it/s]                                                                                                    2.16 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 36 | Train loss: 0.03015 | Validation loss: 0.02099 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.21 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 37 | Train loss: 0.03103 | Validation loss: 0.02156 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.01it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.28 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 38 | Train loss: 0.02331 | Validation loss: 0.01180 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.51it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.99it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.92it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.26 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 39 | Train loss: 0.03066 | Validation loss: 0.02836 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.22 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 40 | Train loss: 0.03144 | Validation loss: 0.02771 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.67it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.46it/s]                                                                                                    2.14 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 41 | Train loss: 0.02795 | Validation loss: 0.01399 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.00it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.40it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    2.26 seconds
tensor([ 26, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 42 | Train loss: 0.02976 | Validation loss: 0.02272 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.99it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.71it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.28 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 43 | Train loss: 0.03060 | Validation loss: 0.01173 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.46it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.19 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 44 | Train loss: 0.01805 | Validation loss: 0.01391 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.56it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.92it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.19it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.32 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 45 | Train loss: 0.02185 | Validation loss: 0.01370 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.44it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.77it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.83it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.13 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 46 | Train loss: 0.02393 | Validation loss: 0.02201 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.75it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.27it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.45it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.07it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.28 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 47 | Train loss: 0.02301 | Validation loss: 0.01367 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.96it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.26 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 48 | Train loss: 0.02417 | Validation loss: 0.01838 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.96it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.42it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.19 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 49 | Train loss: 0.01931 | Validation loss: 0.01498 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.14it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.47it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.36it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.05it/s]                                                                                                    2.25 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 50 | Train loss: 0.02067 | Validation loss: 0.01539 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=6 perturb_router=True topk=1 random_seed=42
Test result | Loss : 96.4 | Score : 87.5
Took 2.33 minutes for training
Took 2.22 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=12 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3104.06it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2732.65it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2951.36it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 9216
prompt_encoder.router.0.weight 3072
trainable params: 12288 || all params: 222894336 || trainable%: 0.005512926088889042
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.16s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.84it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.98it/s]                                                                                                    3.02 seconds
tensor([83, 22, 20, 99], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 1 | Train loss: 0.12990 | Validation loss: 0.04225 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.44it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 83.9
tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.27it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.82it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.92it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.04it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.48it/s]                                                                                                    2.21 seconds
tensor([  5,  16,  26, 177], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 2 | Train loss: 0.10740 | Validation loss: 0.03744 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.48it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.17 seconds
tensor([ 14,  15,  20, 175], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 3 | Train loss: 0.08850 | Validation loss: 0.03350 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.51it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.87it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.72it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  4.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.61it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.06 seconds
tensor([ 19,   7,  14, 184], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 4 | Train loss: 0.08982 | Validation loss: 0.03494 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.01it/s]                                                                                                    2.22 seconds
tensor([ 12,  10,  13, 189], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 5 | Train loss: 0.97266 | Validation loss: 0.07730 | Validation acc: 88.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.86it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.92it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.23 seconds
tensor([ 27,   7,  11, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.11346 | Validation loss: 0.03390 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.47it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.22 seconds
tensor([ 25,   9,   7, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.07133 | Validation loss: 0.03411 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.41it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.31it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.65it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.05it/s]                                                                                                    2.17 seconds
tensor([ 30,   8,   7, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.08078 | Validation loss: 0.03980 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.43it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.36it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.23 seconds
tensor([ 27,   7,   9, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.07274 | Validation loss: 0.03033 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.47it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.46it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.37it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.96it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.23 seconds
tensor([ 32,   5,   4, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.06651 | Validation loss: 0.02740 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.47it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.17it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.91it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.29 seconds
tensor([ 25,   3,   5, 191], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.06630 | Validation loss: 0.02455 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.47it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.31it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.97it/s]                                                                                                    2.23 seconds
tensor([ 26,   8,   9, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.07245 | Validation loss: 0.02757 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.56it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.09 seconds
tensor([ 24,   6,   8, 186], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.05784 | Validation loss: 0.02122 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.46it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.46it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.41it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.24 seconds
tensor([ 30,  13,   5, 176], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.07260 | Validation loss: 0.02421 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.92it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.72it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.72it/s]                                                                                                    2.17 seconds
tensor([ 35,   5,  12, 172], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.05726 | Validation loss: 0.02208 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.76it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.61it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.64it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.99it/s]                                                                                                    2.18 seconds
tensor([ 12,  10,  20, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.05056 | Validation loss: 0.01740 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.49it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.92it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.57it/s]                                                                                                    2.14 seconds
tensor([ 14,  15,   9, 186], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.24it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.05574 | Validation loss: 0.01946 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.65it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.32it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.48it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.33it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.19 seconds
tensor([ 10,  10,  17, 187], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.05526 | Validation loss: 0.02926 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:00,  4.10it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  4.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.70it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.11 seconds
tensor([ 17,  12,  14, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.05270 | Validation loss: 0.01677 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.50it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.87it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.47it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.21 seconds
tensor([ 11,  13,  12, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.05038 | Validation loss: 0.02084 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.58it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.21 seconds
tensor([  9,  15,   8, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.04910 | Validation loss: 0.01488 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.57it/s]                                                                                                    2.15 seconds
tensor([  9,   4,  22, 189], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.06011 | Validation loss: 0.01232 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.48it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.44it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.31it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.15it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.53it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.14 seconds
tensor([ 10,  14,  15, 185], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.04136 | Validation loss: 0.01698 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.29 seconds
tensor([ 13,  12,  11, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.05854 | Validation loss: 0.01087 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.46it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.12it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.22it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.20it/s]                                                                                                    2.26 seconds
tensor([ 12,  16,  14, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.04109 | Validation loss: 0.01355 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.38it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.36it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.86it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.22it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.18 seconds
tensor([  7,  10,   9, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.04045 | Validation loss: 0.01874 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.75it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.53it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.62it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.00it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.20 seconds
tensor([  5,  14,   6, 199], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.05847 | Validation loss: 0.01405 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.86it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.56it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  3.72it/s]                                                                                                    2.02 seconds
tensor([  6,  15,   8, 195], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.04399 | Validation loss: 0.01916 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.02it/s]                                                                                                    2.26 seconds
tensor([ 13,  10,  12, 189], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.03916 | Validation loss: 0.01498 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.57it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.97it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.51it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.64it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.78it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.20it/s]                                                                                                    2.12 seconds
tensor([  8,  15,  15, 186], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.04311 | Validation loss: 0.01606 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.46it/s]                                                                                                    2.12 seconds
tensor([ 15,  14,  13, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.23it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.03150 | Validation loss: 0.00990 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.83it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.65it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.09it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.17 seconds
tensor([ 12,   6,  14, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 32 | Train loss: 0.03405 | Validation loss: 0.01562 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.13it/s]                                                                                                    2.26 seconds
tensor([  7,  11,  15, 191], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 33 | Train loss: 0.03549 | Validation loss: 0.00928 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.45it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.58it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.46it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.99it/s]                                                                                                    2.20 seconds
tensor([  8,  17,  19, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 34 | Train loss: 0.04216 | Validation loss: 0.01085 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.12it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.18 seconds
tensor([ 10,  16,  24, 174], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 35 | Train loss: 0.04110 | Validation loss: 0.01233 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.51it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.88it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.99it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.31 seconds
tensor([ 12,   9,  15, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 36 | Train loss: 0.04114 | Validation loss: 0.01910 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.27it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.14it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.39it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.18 seconds
tensor([  7,  12,  21, 184], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 37 | Train loss: 0.03288 | Validation loss: 0.01120 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.56it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.27it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.29it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.53it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.22 seconds
tensor([ 11,   5,  18, 190], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 38 | Train loss: 0.02926 | Validation loss: 0.01022 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.40it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.01it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.52it/s]                                                                                                    2.15 seconds
tensor([  6,  21,  17, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 39 | Train loss: 0.03105 | Validation loss: 0.00899 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.44it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.82it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.12it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.76it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.23 seconds
tensor([ 10,  13,  14, 187], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 40 | Train loss: 0.03431 | Validation loss: 0.00964 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.95it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.61it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.12it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.14 seconds
tensor([  6,   9,  21, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 41 | Train loss: 0.03402 | Validation loss: 0.01122 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.64it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.19it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.17 seconds
tensor([ 12,  11,  18, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 42 | Train loss: 0.02548 | Validation loss: 0.01178 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.33it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.58it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.14 seconds
tensor([  8,   6,  19, 191], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 43 | Train loss: 0.02713 | Validation loss: 0.01469 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.58it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.42it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.23it/s]                                                                                                    2.15 seconds
tensor([ 11,  12,  19, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 44 | Train loss: 0.02941 | Validation loss: 0.01369 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.46it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.56it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([ 10,  11,  12, 191], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 45 | Train loss: 0.02708 | Validation loss: 0.00985 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.21 seconds
tensor([  8,   7,  17, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 46 | Train loss: 0.02851 | Validation loss: 0.01125 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.91it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.12it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.18 seconds
tensor([ 14,   8,  15, 187], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 47 | Train loss: 0.02837 | Validation loss: 0.01097 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.58it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.74it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.70it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.21 seconds
tensor([  9,  12,  17, 186], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 48 | Train loss: 0.02736 | Validation loss: 0.01114 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.81it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.57it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.43it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.12 seconds
tensor([ 10,   8,  14, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 49 | Train loss: 0.02762 | Validation loss: 0.01334 | Validation acc: 100.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=12 perturb_router=True topk=1 random_seed=42
Test result | Loss : 96.4 | Score : 83.9
Took 2.28 minutes for training
Took 2.20 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=30 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3111.91it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2754.88it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2971.67it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 23040
prompt_encoder.router.0.weight 7680
trainable params: 30720 || all params: 222912768 || trainable%: 0.01378117560318483
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.19s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.47it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.50it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.85it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.70it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.86it/s]                                                                                                    3.02 seconds
tensor([40,  5, 42, 54, 32,  5,  1, 14, 23,  8], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.16305 | Validation loss: 0.15748 | Validation acc: 73.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.19it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.88it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 78.6
tensor([  0,   0, 112,   0,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.82it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.08 seconds
tensor([ 47,   1, 161,   0,   9,   1,   0,   0,   0,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.09931 | Validation loss: 0.04677 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 87.5
tensor([  2,   0, 110,   0,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.12it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.18it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.57it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.21 seconds
tensor([ 51,   0, 159,   1,  10,   1,   1,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.09763 | Validation loss: 0.10131 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.91it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.56it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.63it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  4.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.09 seconds
tensor([  5,   1,  27,   0,   0,  28, 163,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.09588 | Validation loss: 0.03450 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 112,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.36it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.48it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.01it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.20 seconds
tensor([  5,   0,  23,   0,   0,  39, 157,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.09290 | Validation loss: 0.06503 | Validation acc: 88.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.46it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.59it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.02it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.16 seconds
tensor([  7,   0,  43,   0,   0,  24, 150,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.09899 | Validation loss: 0.03487 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.31it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.36it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.20 seconds
tensor([  4,   0,  22,   0,   0,  30, 168,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.07702 | Validation loss: 0.03158 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.85it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 112,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.52it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.41it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.23 seconds
tensor([  6,   1,  19,   0,   0,  22, 176,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.06637 | Validation loss: 0.03270 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.87it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.23 seconds
tensor([  3,   0,  55,   0,   0,  14, 152,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.07165 | Validation loss: 0.02604 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.84it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 112,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.17it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.78it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.52it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.63it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.47it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.17 seconds
tensor([  7,   1,  51,   0,   0,  17, 147,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.07417 | Validation loss: 0.02905 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.99it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.23 seconds
tensor([  4,   1,  43,   0,   0,  16, 160,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.07026 | Validation loss: 0.03161 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  3.00it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.95it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.28 seconds
tensor([  3,   0,  44,   1,   0,  13, 163,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.06405 | Validation loss: 0.03700 | Validation acc: 100.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.81it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.12it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.00it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.25 seconds
tensor([  4,   1,  41,   0,   0,  17, 160,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.06465 | Validation loss: 0.03929 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.37it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.67it/s]                                                                                                    2.10 seconds
tensor([  3,   1, 118,   0,   0,   7,  91,   3,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.06780 | Validation loss: 0.03767 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.29it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.88it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.23 seconds
tensor([ 4,  0, 96,  0,  1,  5, 92, 26,  0,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.08315 | Validation loss: 0.04064 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.81it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.96it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.69it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.69it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.57it/s]                                                                                                    2.16 seconds
tensor([  0,   1, 112,   0,   0,   5,  43,  62,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0, 52,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.07646 | Validation loss: 0.03416 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.16it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.49it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.48it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.17 seconds
tensor([  1,   0, 112,   0,   0,   7,  42,  62,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0, 24,  0,  0,  0, 28,  0,  0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.06807 | Validation loss: 0.03230 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.66it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.49it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.58it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.18 seconds
tensor([ 0,  0, 96,  0,  0,  0, 98, 30,  0,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0, 24,  0,  0,  0, 28,  0,  0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.06194 | Validation loss: 0.03076 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.80it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.95it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.34it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.19 seconds
tensor([  2,   0,  71,   0,   0,   1, 111,  38,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  8,  0,  0,  0, 44,  0,  0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.05321 | Validation loss: 0.03533 | Validation acc: 100.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=30 perturb_router=True topk=1 random_seed=42
Test result | Loss : 92.9 | Score : 87.5
Took 0.88 minutes for training
Took 2.23 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=60 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 2943.56it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2650.49it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2885.55it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 46080
prompt_encoder.router.0.weight 15360
trainable params: 61440 || all params: 222943488 || trainable%: 0.027558553313743794
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:08,  1.38s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.40it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.39it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.11it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    3.00 seconds
tensor([ 6, 22,  1,  0,  3,  4,  3, 15,  3, 48, 14, 80,  3,  0,  0,  8,  1, 10,
         2,  1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.11727 | Validation loss: 0.05216 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  3.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.17it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 82.1
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.33it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.26 seconds
tensor([  0,   1,   1,   0,   0,   1,   0,   2,   0,  50,   1, 128,   0,   0,
          0,   0,  38,   2,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.10218 | Validation loss: 0.06012 | Validation acc: 100.0
Updating result due to higher validation score
Epoch 2 test result: 82.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.20it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.88it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.16 seconds
tensor([  0,   0,  18,   0,   0,   0,   0,   0,   0,  52,   0, 136,   0,   0,
          0,   0,  18,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.10200 | Validation loss: 0.03931 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  3.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.16it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.23it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.99it/s]                                                                                                    2.27 seconds
tensor([  0,   0,  19,   0,   0,   0,   0,   2,   0,  74,   0, 112,   0,   0,
          0,   0,  13,   4,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.08149 | Validation loss: 0.03706 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  3.18it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.19it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.26 seconds
tensor([  0,   0,  11,   0,   0,   0,   0,   0,   0,  57,   0, 134,   0,   0,
          1,   0,  21,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.09602 | Validation loss: 0.04031 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.16 seconds
tensor([  0,   0,  18,   0,   0,   0,   0,   0,   0,  35,   0, 140,   0,   0,
          0,   0,  30,   1,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.08773 | Validation loss: 0.03966 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.16it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.20it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.87it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.24 seconds
tensor([  0,   0,  12,   0,   0,  33,   0,   0,   0,  41,   0, 127,   0,   0,
          0,   0,  11,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 12,  0,  0,  0,  0,  0, 40,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.08703 | Validation loss: 0.05679 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.97it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.18it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.71it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    2.19 seconds
tensor([  0,   0,  15,   0,   0,  75,   0,   0,   0,  16,   0, 107,   0,   0,
          0,   0,  11,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 12,  0,  0,  0,  0,  0, 40,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.11611 | Validation loss: 0.04273 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.93it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.91it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.49it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.20 seconds
tensor([  0,   0,  11,   0,   0, 121,   0,   1,   0,  16,   0,  69,   0,   0,
          0,   0,   6,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.09607 | Validation loss: 0.05769 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.61it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.17 seconds
tensor([  0,   0,   5,   0,   0, 168,   0,   0,   0,   3,   0,  43,   0,   0,
          0,   0,   4,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.08094 | Validation loss: 0.04281 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.17it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.58it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.23 seconds
tensor([  0,   0,   6,   0,   1, 171,   0,   0,   0,   3,   0,  39,   0,   0,
          0,   0,   4,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.11166 | Validation loss: 0.05812 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.92it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.72it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.18it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.26 seconds
tensor([  0,   0,   8,   0,   1, 166,   0,   0,   0,   2,   0,  31,   0,   0,
          0,   0,   8,   8,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.08640 | Validation loss: 0.04857 | Validation acc: 92.3
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.12it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.62it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.19 seconds
tensor([  0,   0,   8,   0,   1, 170,   0,   0,   0,   1,   0,  28,   0,   0,
          0,   0,   5,  11,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.08003 | Validation loss: 0.04722 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.23it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.30it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.29it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.67it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.71it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.53it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.16 seconds
tensor([  0,   0,   5,   0,   1, 169,   0,   0,   0,   3,   0,  32,   0,   0,
          0,   0,   2,  11,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.07934 | Validation loss: 0.05126 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=60 perturb_router=True topk=1 random_seed=42
Test result | Loss : 85.7 | Score : 82.1
Took 0.65 minutes for training
Took 2.27 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3110.33it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2737.87it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2952.55it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 7680
prompt_encoder.router.0.weight 1536
trainable params: 9216 || all params: 222891264 || trainable%: 0.004134751553116052
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.23s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:02,  1.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.86it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.93it/s]                                                                                                    3.11 seconds
tensor([200,  24], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 1 | Train loss: 0.12340 | Validation loss: 0.04770 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.18it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.16it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 87.5
tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.59it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.67it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.15 seconds
tensor([ 42, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 2 | Train loss: 0.09576 | Validation loss: 0.04554 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.17it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.14it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 89.3
tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.93it/s]                                                                                                    2.31 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 3 | Train loss: 0.10499 | Validation loss: 0.07994 | Validation acc: 88.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.10it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.13 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 4 | Train loss: 0.10554 | Validation loss: 0.06770 | Validation acc: 88.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.09it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.56it/s]                                                                                                    2.23 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 5 | Train loss: 0.10020 | Validation loss: 0.04174 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.13it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.21it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.98it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.13it/s]                                                                                                    2.31 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.08060 | Validation loss: 0.03807 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.11it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.41it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.11it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.14it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.19 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.07329 | Validation loss: 0.05850 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.56it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.92it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.23it/s]                                                                                                    2.24 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.08356 | Validation loss: 0.04836 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.87it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.88it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.02it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.51it/s]                                                                                                    2.21 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.07251 | Validation loss: 0.03811 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.58it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.53it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.99it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.09it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.20 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.06328 | Validation loss: 0.04460 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.29it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.19it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.84it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.56it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.60it/s]                                                                                                    2.13 seconds
tensor([ 24, 200], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07166 | Validation loss: 0.03573 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.10it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.36it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.60it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.77it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.16 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.06975 | Validation loss: 0.02787 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.42it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.94it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.13it/s]                                                                                                    2.23 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.05941 | Validation loss: 0.02764 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.84it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.23it/s]                                                                                                    2.29 seconds
tensor([ 24, 200], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.05934 | Validation loss: 0.02816 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.49it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.01it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.18 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.05256 | Validation loss: 0.02807 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.18it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.29it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.04it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    2.21 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.05418 | Validation loss: 0.01683 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.17it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.13it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.21it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.91it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.01it/s]                                                                                                    2.29 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.04854 | Validation loss: 0.01950 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.59it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.81it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.14 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.03612 | Validation loss: 0.03074 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.36it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.42it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.19 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.03938 | Validation loss: 0.01571 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.01it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.45it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.36it/s]                                                                                                    2.20 seconds
tensor([ 26, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.04216 | Validation loss: 0.01181 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.65it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.21 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.03577 | Validation loss: 0.02821 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.59it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.22 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.03169 | Validation loss: 0.01609 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.56it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.82it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.29it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.23 seconds
tensor([ 24, 200], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.03713 | Validation loss: 0.00888 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.31it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.99it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.71it/s]                                                                                                    2.11 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.03792 | Validation loss: 0.00640 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.13it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.75it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.02it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.29 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.02907 | Validation loss: 0.02219 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.84it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.22 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.02609 | Validation loss: 0.01017 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.03it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.60it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.66it/s]                                                                                                    2.16 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.02143 | Validation loss: 0.00523 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.11it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.65it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.85it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.56it/s]                                                                                                    2.24 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.02241 | Validation loss: 0.00735 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.16it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.92it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.98it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.09it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.27 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.02472 | Validation loss: 0.00463 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.13it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.16it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.78it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.15it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.70it/s]                                                                                                    2.13 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.03167 | Validation loss: 0.00918 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.74it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  3.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.59it/s]                                                                                                    2.18 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.02472 | Validation loss: 0.02064 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.70it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.69it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.03it/s]                                                                                                    2.18 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 32 | Train loss: 0.02188 | Validation loss: 0.00608 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.86it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.84it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.12 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 33 | Train loss: 0.02097 | Validation loss: 0.00493 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.75it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.14 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 34 | Train loss: 0.02688 | Validation loss: 0.00571 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.55it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.24 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 35 | Train loss: 0.02029 | Validation loss: 0.00872 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.32it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.73it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.56it/s]                                                                                                    2.17 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 36 | Train loss: 0.02085 | Validation loss: 0.00516 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.78it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.20 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 37 | Train loss: 0.02483 | Validation loss: 0.00438 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.11it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.92it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.23 seconds
tensor([ 77, 147], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 38 | Train loss: 0.03597 | Validation loss: 0.02893 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.46it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.57it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.79it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.67it/s]                                                                                                    2.05 seconds
tensor([198,  26], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 39 | Train loss: 0.05133 | Validation loss: 0.03157 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.75it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.11it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.75it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([203,  21], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 40 | Train loss: 0.03735 | Validation loss: 0.01157 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.88it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.63it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.42it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.16 seconds
tensor([196,  28], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 41 | Train loss: 0.04534 | Validation loss: 0.01216 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.86it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.64it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  3.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.30 seconds
tensor([207,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 42 | Train loss: 0.03711 | Validation loss: 0.01337 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.35it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.88it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.98it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.30 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 43 | Train loss: 0.03410 | Validation loss: 0.00929 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.09it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.30 seconds
tensor([202,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 44 | Train loss: 0.02651 | Validation loss: 0.00691 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.53it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.13it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.23 seconds
tensor([202,  22], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 45 | Train loss: 0.03691 | Validation loss: 0.00798 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.58it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.65it/s]                                                                                                    2.20 seconds
tensor([203,  21], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 46 | Train loss: 0.03067 | Validation loss: 0.00839 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.53it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.80it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.27 seconds
tensor([198,  26], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 47 | Train loss: 0.02892 | Validation loss: 0.00742 | Validation acc: 100.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Test result | Loss : 92.9 | Score : 89.3
Took 2.20 minutes for training
Took 2.23 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3150.67it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2780.38it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2997.54it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 3072
trainable params: 18432 || all params: 222900480 || trainable%: 0.008269161196961083
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:07,  1.22s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:02,  1.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.73it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  3.07it/s]                                                                                                    3.03 seconds
tensor([159,  18,  27,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 1 | Train loss: 0.14090 | Validation loss: 0.21688 | Validation acc: 61.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.72it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 76.8
tensor([ 12,   0,   0, 100], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.63it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.17 seconds
tensor([ 63,  18, 103,  40], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0, 52,  0], device='cuda:0')
Epoch 2 | Train loss: 0.09528 | Validation loss: 0.05271 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 87.5
tensor([  0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.51it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.25 seconds
tensor([ 17,  12, 184,  11], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.62it/s]                                                                                                    tensor([ 0,  0, 52,  0], device='cuda:0')
Epoch 3 | Train loss: 0.11500 | Validation loss: 9.89897 | Validation acc: 0.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.34it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.52it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.24 seconds
tensor([ 11,  12, 147,  54], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 4 | Train loss: 5.42652 | Validation loss: 0.26073 | Validation acc: 46.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.51it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.33it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.19 seconds
tensor([  9,  12,  11, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 5 | Train loss: 0.21152 | Validation loss: 0.05451 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.91it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.04it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.24 seconds
tensor([ 12,  11,  11, 190], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.09886 | Validation loss: 0.04528 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.69it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.44it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.22 seconds
tensor([ 15,  13,  13, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.09452 | Validation loss: 0.03569 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    Updating result due to higher validation score
Epoch 7 test result: 89.3
tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.47it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.66it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.47it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.26 seconds
tensor([ 16,  11,  10, 187], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.09399 | Validation loss: 0.03410 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.94it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.47it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.17 seconds
tensor([ 16,   7,   9, 192], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.08755 | Validation loss: 0.03138 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.16it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.21 seconds
tensor([ 10,  22,  14, 178], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.08799 | Validation loss: 0.02962 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.09it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.13it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.29 seconds
tensor([ 17,  15,  10, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07850 | Validation loss: 0.02729 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.80it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.01it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.71it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.09it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.31 seconds
tensor([ 86,   6,   6, 126], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.07451 | Validation loss: 0.04981 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.95it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.00it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.74it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.96it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.75it/s]                                                                                                    2.18 seconds
tensor([ 86,   6,   5, 127], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.09148 | Validation loss: 0.03854 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.15it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.64it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.22 seconds
tensor([ 95,   9,   5, 115], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.08231 | Validation loss: 0.03472 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.21it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.49it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.99it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.61it/s]                                                                                                    2.11 seconds
tensor([ 83,  10,   4, 127], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.08072 | Validation loss: 0.03217 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.02it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.51it/s]                                                                                                    2.24 seconds
tensor([ 90,   4,   3, 127], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.09583 | Validation loss: 0.03263 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.53it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.91it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.37it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.19 seconds
tensor([ 75,  11,   1, 137], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.07492 | Validation loss: 0.03656 | Validation acc: 100.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.41it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.24 seconds
tensor([ 76,   4,   7, 137], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.06854 | Validation loss: 0.02917 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.26it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.72it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.43it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.69it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.53it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.14 seconds
tensor([ 71,   8,   6, 139], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.06525 | Validation loss: 0.03276 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.26 seconds
tensor([ 75,  11,   7, 131], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.07022 | Validation loss: 0.02332 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.72it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.96it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.68it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.73it/s]                                                                                                    2.20 seconds
tensor([ 71,   8,   3, 142], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.05129 | Validation loss: 0.02289 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.69it/s]                                                                                                    tensor([  2,   0,   0, 110], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.93it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.60it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.11it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.26 seconds
tensor([ 79,  12,   7, 126], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.05537 | Validation loss: 0.03345 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.23 seconds
tensor([ 68,   4,   7, 145], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.05425 | Validation loss: 0.01707 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    tensor([  2,   0,   0, 110], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.90it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.30 seconds
tensor([ 82,   7,   6, 129], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.04846 | Validation loss: 0.01325 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  6,   0,   0, 106], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.44it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.84it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.46it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.70it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.13 seconds
tensor([ 43,   7,   6, 168], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.05962 | Validation loss: 0.01199 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.69it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.57it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.94it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.23 seconds
tensor([ 11,  11,   9, 193], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.05818 | Validation loss: 0.01818 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.97it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.95it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.73it/s]                                                                                                    2.18 seconds
tensor([  9,  11,  13, 191], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.06103 | Validation loss: 0.01472 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.70it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.18 seconds
tensor([ 15,  12,  18, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.05323 | Validation loss: 0.01641 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.70it/s]                                                                                                    2.16 seconds
tensor([  9,  16,  16, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.05032 | Validation loss: 0.03701 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.31it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.40it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.97it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.25 seconds
tensor([  7,   5,  16, 196], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.05994 | Validation loss: 0.01501 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.14it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.83it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.29 seconds
tensor([ 14,  13,  16, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.04912 | Validation loss: 0.01937 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.46it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]                                                                                                    2.26 seconds
tensor([  6,  21,  15, 182], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 32 | Train loss: 0.05444 | Validation loss: 0.02295 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.81it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.07it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.60it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.88it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.90it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.10 seconds
tensor([ 12,  14,  14, 184], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 33 | Train loss: 0.04008 | Validation loss: 0.05001 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.39it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.59it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.37it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.96it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.03it/s]                                                                                                    2.23 seconds
tensor([  9,  17,  17, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 34 | Train loss: 0.05424 | Validation loss: 0.03176 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.14it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.49it/s]                                                                                                    2.19 seconds
tensor([  9,  13,  13, 189], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 35 | Train loss: 0.03900 | Validation loss: 0.01857 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 89.3 | Score : 89.3
Took 1.69 minutes for training
Took 2.24 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=50 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3092.67it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2751.54it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2950.99it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 38400
prompt_encoder.router.0.weight 7680
trainable params: 46080 || all params: 222928128 || trainable%: 0.020670339096912883
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.14s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.47it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.92it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.83it/s]                                                                                                    2.97 seconds
tensor([ 8,  3,  9,  7, 26,  5, 43, 13, 78, 32], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  2, 50], device='cuda:0')
Epoch 1 | Train loss: 0.14347 | Validation loss: 0.11548 | Validation acc: 76.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 83.9
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.08it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.62it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.80it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.54it/s]                                                                                                    2.25 seconds
tensor([ 0,  0,  0,  0,  0,  1, 82, 19, 30, 92], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52], device='cuda:0')
Epoch 2 | Train loss: 0.09477 | Validation loss: 0.11368 | Validation acc: 88.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 83.9
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.19it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.11it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.46it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.99it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.25 seconds
tensor([ 7,  2,  1, 72, 28,  1, 70,  1,  0, 42], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 1.10878 | Validation loss: 0.10265 | Validation acc: 84.6
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.51it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.81it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.12it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.33 seconds
tensor([ 16,   0,   0, 152,  47,   1,   0,   6,   0,   2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.04it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.11482 | Validation loss: 0.08370 | Validation acc: 84.6
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.24it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.99it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.13it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.25 seconds
tensor([ 11,   2,   1, 155,  44,   1,   1,   8,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.09371 | Validation loss: 0.05024 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.20it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.68it/s]                                                                                                    Updating result due to higher validation score
Epoch 5 test result: 83.9
tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.52it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.73it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.46it/s]                                                                                                    2.09 seconds
tensor([ 18,   0,   0, 169,   9,   0,   0,  26,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.08385 | Validation loss: 0.04105 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.60it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.76it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.24 seconds
tensor([ 17,   7,   0, 169,   6,   0,   6,  18,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.08502 | Validation loss: 0.09734 | Validation acc: 88.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.13it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.57it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.64it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.75it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.17 seconds
tensor([ 12,   3,   0, 165,   7,   3,   3,  29,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.07790 | Validation loss: 0.04070 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.22it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    Updating result due to higher validation score
Epoch 8 test result: 85.7
tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.58it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.98it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.20it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.27 seconds
tensor([ 14,   3,   1, 169,   0,   0,   1,  32,   1,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.07686 | Validation loss: 0.04175 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.01it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.48it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.75it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.64it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.75it/s]                                                                                                    2.07 seconds
tensor([ 16,   1,   1, 173,   2,   0,   0,  28,   2,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.08074 | Validation loss: 0.03437 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.23it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.71it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.92it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.28 seconds
tensor([ 15,   2,   0, 162,   2,   0,   3,  36,   0,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.07998 | Validation loss: 0.03780 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.60it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.62it/s]                                                                                                    2.11 seconds
tensor([ 15,   2,   1, 175,   0,   1,   1,  27,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.08797 | Validation loss: 0.04952 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.60it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.21 seconds
tensor([  6,   2,   0, 184,   3,   1,   1,  25,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.05928 | Validation loss: 0.05664 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.34it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.72it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.43it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.78it/s]                                                                                                    2.09 seconds
tensor([ 17,   4,   1, 169,   1,   2,   0,  29,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.06458 | Validation loss: 0.05210 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.40it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.62it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.40it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.99it/s]                                                                                                    2.22 seconds
tensor([ 20,   4,   0, 158,   0,   2,   0,  38,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.08880 | Validation loss: 0.06313 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.66it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.19it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.50it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.22 seconds
tensor([ 12,   0,   0, 160,   5,   0,   2,  44,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.06297 | Validation loss: 0.04852 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.40it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.24 seconds
tensor([ 14,   1,   0, 160,   1,   1,   1,  39,   4,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.05265 | Validation loss: 0.05832 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.91it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.02it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.30 seconds
tensor([  9,   1,   1, 173,   0,   0,   1,  39,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.05it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.04729 | Validation loss: 0.04228 | Validation acc: 96.2
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.45it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.43it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.21it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.39it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.57it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.53it/s]                                                                                                    2.17 seconds
tensor([ 16,   1,   1, 152,   2,   1,   1,  50,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52,  0,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.06083 | Validation loss: 0.05593 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.87it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.65it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.46it/s]                                                                                                    2.24 seconds
tensor([ 13, 164,   1,   1,   1,   1,   3,  40,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52,  0,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.10295 | Validation loss: 0.04208 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=50 perturb_router=True topk=1 random_seed=42
Test result | Loss : 89.3 | Score : 85.7
Took 0.98 minutes for training
Took 2.25 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3153.72it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2780.23it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2985.91it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 76800
prompt_encoder.router.0.weight 15360
trainable params: 92160 || all params: 222974208 || trainable%: 0.04133213470142699
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.13s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.00it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.36it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.72it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.61it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.81it/s]                                                                                                    3.07 seconds
tensor([ 6,  1,  0,  0, 11,  1,  1,  2, 13,  1, 78,  9,  0,  0,  0,  2,  6, 13,
        76,  4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.12550 | Validation loss: 0.04976 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.21it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.72it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 82.1
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.24it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.65it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.21 seconds
tensor([  0,   0,   1,   0,   0,   0,   0,   0,  49,   0, 102,   1,   1,  62,
          1,   0,   0,   1,   5,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.10095 | Validation loss: 0.03820 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.20it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.72it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.77it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.24 seconds
tensor([  1,   0,   0,   1,   0,   0,   0,   1,   3,   0,  69,   1,   0, 139,
          5,   0,   0,   0,   4,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.07448 | Validation loss: 0.04008 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.41it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.57it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.69it/s]                                                                                                    2.12 seconds
tensor([  0,   0,   0,   0,   0,   0,   7,   1,   3,   0,  92,   0,   0, 106,
          0,   0,   0,  11,   3,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 50,  0,  0,  2,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.07987 | Validation loss: 0.03303 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.17it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.69it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 106,   0,   0,   6,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.58it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.91it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.27it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.33it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.96it/s]                                                                                                    2.31 seconds
tensor([  0,   0,   0,   0,   0,   0,   9,   0,   2,   0, 100,   1,   0,  91,
          0,   0,   0,  20,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 34,  0,  0, 18,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.09806 | Validation loss: 0.04444 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.50it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.97it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.28 seconds
tensor([ 0,  0,  0, 15,  0,  0,  4,  0,  2,  0, 88,  0,  0, 35,  1,  0,  0, 79,
         0,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 16,  0,  0,  0,  0,  0,  0, 36,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.56085 | Validation loss: 0.09709 | Validation acc: 84.6
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.95it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.12it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.23 seconds
tensor([ 0,  0,  0, 89,  0,  0,  6,  0,  1,  0, 46,  0,  0,  0,  0,  0,  0, 82,
         0,  0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.09853 | Validation loss: 0.03771 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.10it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.83it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.25 seconds
tensor([  0,   0,   0, 112,   0,   0,   1,   0,   0,   0,  49,   0,   0,   1,
          0,   0,   0,  61,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.07731 | Validation loss: 0.02937 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.18it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.69it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.76it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.65it/s]                                                                                                    2.17 seconds
tensor([  0,   0,   0, 111,   0,   0,   5,   0,   1,   0,  45,   1,   0,   3,
          0,   0,   1,  57,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.08181 | Validation loss: 0.02858 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.18it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.20it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.23it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.81it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.01it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]                                                                                                    2.22 seconds
tensor([  0,   0,   0, 109,   0,   0,   4,   0,   1,   1,  42,   0,   5,   0,
          0,   0,   0,  61,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.22it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.06755 | Validation loss: 0.03044 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.09it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.72it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.33it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.61it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.19 seconds
tensor([  0,   0,   0, 115,   0,   0,   6,   0,   0,   0,  39,   0,   5,   0,
          0,   0,   0,  59,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.07791 | Validation loss: 0.02281 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.18it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.70it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([  0,   0,   0, 112,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.03it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.48it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.42it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.29it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.24 seconds
tensor([  0,   0,   0, 129,   0,   0,   3,   0,   0,   0,  39,   0,   4,   0,
          0,   0,   0,  49,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.07357 | Validation loss: 0.09307 | Validation acc: 88.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.12it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.67it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.84it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.33it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.28 seconds
tensor([  0,   0,   0,   1,   0,   1,   5,   0,   0,   1,  31,   0,   3,   0,
          0,   0,   0, 177,   5,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.10160 | Validation loss: 0.06095 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.37it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.27it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.18it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.22 seconds
tensor([  0,   0,   0,   2,   0,   0,   5,   0,   2,   1,  39,   0,   3,   0,
          0,   0,   0, 171,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.08706 | Validation loss: 0.03693 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.01it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.71it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.09it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.75it/s]                                                                                                    2.14 seconds
tensor([  0,   0,   0,   5,   0,   0,   6,   0,   1,   2,  32,   0,   5,   4,
          0,   0,   0, 166,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.07903 | Validation loss: 0.09070 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.63it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.73it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.11it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.28 seconds
tensor([  0,   0,   0,   5,   0,   0,   7,   0,   1,   3,  13,   1,  14,   3,
          0,   0,   0, 173,   4,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.11383 | Validation loss: 0.03241 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.80it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.95it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.48it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.00it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.07it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.23 seconds
tensor([  1,   0,   0,   6,   0,   1,   8,   1,   2,   1,  11,   0,   5,   3,
          1,   0,   0, 181,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.06804 | Validation loss: 0.04434 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.17it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.18 seconds
tensor([  0,   0,   0,   4,   0,   0,   6,   0,   2,   4,  10,   0,   8,   6,
          1,   0,   0, 175,   8,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.07016 | Validation loss: 0.03244 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.65it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.49it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.97it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.19 seconds
tensor([  0,   0,   0,   2,   0,   0,   3,   0,   1,  43,   3,   1,   5,   0,
          1,   0,   0, 163,   2,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.08581 | Validation loss: 0.03750 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.16it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.27 seconds
tensor([  0,   0,   0,   3,   0,   0,   4,   1,   2,  43,   1,   0,   4,   0,
          0,   0,   0, 159,   7,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.06973 | Validation loss: 0.04267 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.44it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.45it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.47it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.32it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.12 seconds
tensor([  0,   0,   0,   1,   0,   0,   5,   0,   1,  48,   4,   0,   5,   0,
          0,   0,   0, 157,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,
         0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.05289 | Validation loss: 0.03881 | Validation acc: 100.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Test result | Loss : 92.9 | Score : 82.1
Took 0.99 minutes for training
Took 2.26 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3086.60it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2740.14it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2950.58it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 1536
trainable params: 16896 || all params: 222898944 || trainable%: 0.0075801166648864875
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.11s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.42it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.01it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.60it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.85it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.92it/s]                                                                                                    3.04 seconds
tensor([117, 107], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 1 | Train loss: 0.12217 | Validation loss: 0.05367 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.16it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 85.7
tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.73it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.25 seconds
tensor([209,  15], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 2 | Train loss: 0.13765 | Validation loss: 0.07195 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.43it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.32 seconds
tensor([216,   8], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 3 | Train loss: 0.10925 | Validation loss: 0.05185 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.12it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.08it/s]                                                                                                    Updating result due to higher validation score
Epoch 3 test result: 87.5
tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.61it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.45it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.77it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.60it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.76it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.14it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.16 seconds
tensor([196,  28], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 4 | Train loss: 0.10782 | Validation loss: 0.06138 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  3.00it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.27it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.88it/s]                                                                                                    2.30 seconds
tensor([215,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 5 | Train loss: 0.11374 | Validation loss: 0.03413 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.12it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.08it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.48it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.42it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.93it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.35it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]                                                                                                    2.22 seconds
tensor([204,  20], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 6 | Train loss: 0.07863 | Validation loss: 0.03296 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.09it/s]                                                                                                    tensor([112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.06it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.70it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.29 seconds
tensor([208,  16], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([52,  0], device='cuda:0')
Epoch 7 | Train loss: 0.07807 | Validation loss: 0.03816 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.20 seconds
tensor([195,  29], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([16, 36], device='cuda:0')
Epoch 8 | Train loss: 0.06849 | Validation loss: 0.04562 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.22it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.30it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.66it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.34it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.01it/s]                                                                                                    2.24 seconds
tensor([122, 102], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.10051 | Validation loss: 0.05585 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.50it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.77it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.59it/s]                                                                                                    2.24 seconds
tensor([ 16, 208], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.09663 | Validation loss: 0.04627 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.50it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.37it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07706 | Validation loss: 0.04328 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.77it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.58it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.79it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.32 seconds
tensor([ 22, 202], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.07962 | Validation loss: 0.04474 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.00it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.26it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.30 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.07164 | Validation loss: 0.03100 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.12it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.08it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.62it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.38it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.27 seconds
tensor([ 14, 210], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.07174 | Validation loss: 0.05923 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.24it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.97it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.31it/s]                                                                                                    2.22 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.06213 | Validation loss: 0.05116 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.58it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.94it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.73it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.52it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.71it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.13it/s]                                                                                                    2.16 seconds
tensor([  9, 215], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.05158 | Validation loss: 0.04250 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.32it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.77it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.30 seconds
tensor([ 19, 205], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.05072 | Validation loss: 0.03013 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.09it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.82it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.73it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.50it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.99it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.20 seconds
tensor([ 27, 197], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.04536 | Validation loss: 0.06879 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.49it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.11it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.47it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.43it/s]                                                                                                    2.25 seconds
tensor([ 26, 198], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.04206 | Validation loss: 0.04057 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.82it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.01it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.98it/s]                                                                                                    2.35 seconds
tensor([ 13, 211], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.04666 | Validation loss: 0.06467 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.32it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.36it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.32 seconds
tensor([ 12, 212], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.04893 | Validation loss: 0.02855 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.09it/s]                                                                                                    tensor([  0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.30it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.96it/s]                                                                                                    2.28 seconds
tensor([ 23, 201], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.04069 | Validation loss: 0.03292 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.67it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.88it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.91it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.29it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.53it/s]                                                                                                    2.26 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.03461 | Validation loss: 0.08461 | Validation acc: 80.8
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.49it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.68it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.20it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.20it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.32 seconds
tensor([ 21, 203], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.03890 | Validation loss: 0.07231 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.67it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.88it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.27 seconds
tensor([ 20, 204], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.03555 | Validation loss: 0.03973 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.70it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.39it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.92it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.30 seconds
tensor([ 24, 200], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.03137 | Validation loss: 0.06705 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.27it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.56it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.61it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.23 seconds
tensor([  8, 216], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.03644 | Validation loss: 0.04278 | Validation acc: 100.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.86it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.05it/s]                                                                                                    2.33 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.03371 | Validation loss: 0.06498 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.75it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.95it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.68it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.84it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.45it/s]                                                                                                    2.29 seconds
tensor([ 18, 206], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.03385 | Validation loss: 0.05440 | Validation acc: 96.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.50it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.40it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.28it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.91it/s]                                                                                                    2.25 seconds
tensor([ 15, 209], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.02843 | Validation loss: 0.04915 | Validation acc: 92.3
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.32it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.08it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.39it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.41it/s]                                                                                                    2.23 seconds
tensor([ 17, 207], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.02225 | Validation loss: 0.10459 | Validation acc: 80.8
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 94.6 | Score : 87.5
Took 1.45 minutes for training
Took 2.29 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=40 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3083.71it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2737.80it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2931.94it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 30720
prompt_encoder.router.0.weight 3072
trainable params: 33792 || all params: 222915840 || trainable%: 0.015159084253501232
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.15s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:02,  1.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.58it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.78it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.63it/s]                                                                                                    3.17 seconds
tensor([ 10, 155,  35,  24], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0, 52,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.13063 | Validation loss: 0.06804 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.12it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.65it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 83.9
tensor([  0, 112,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.37it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.94it/s]                                                                                                    2.30 seconds
tensor([ 11, 178,  18,  17], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0, 52,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.10139 | Validation loss: 0.04084 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.64it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 85.7
tensor([  0, 112,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.86it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.38it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.22 seconds
tensor([ 23, 166,  14,  21], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0, 52,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.08394 | Validation loss: 0.03517 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.14it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.65it/s]                                                                                                    tensor([  0, 112,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.70it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.83it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.58it/s]                                                                                                    2.24 seconds
tensor([  9, 152,  45,  18], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0, 52,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.07820 | Validation loss: 0.03862 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.59it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.34it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.52it/s]                                                                                                    2.20 seconds
tensor([  5, 161,  17,  41], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0, 48,  0,  4], device='cuda:0')
Epoch 5 | Train loss: 0.08099 | Validation loss: 0.03471 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.10it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([ 0, 94,  0, 18], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.75it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.27it/s]                                                                                                    2.26 seconds
tensor([  8, 158,  12,  46], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 6 | Train loss: 0.08286 | Validation loss: 0.03711 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.90it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.39it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.69it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.16 seconds
tensor([  5,  37,   7, 175], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 7 | Train loss: 0.08851 | Validation loss: 0.04801 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.81it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.90it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.03it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.04it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.01it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.21it/s]                                                                                                    2.28 seconds
tensor([ 42,   9,   7, 166], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 8 | Train loss: 0.09975 | Validation loss: 0.04189 | Validation acc: 92.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.97it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.61it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.14it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.38 seconds
tensor([ 66,   3,   3, 152], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 9 | Train loss: 0.08836 | Validation loss: 0.04368 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.94it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.52it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.24it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.22 seconds
tensor([ 70,   3,   2, 149], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 10 | Train loss: 0.08850 | Validation loss: 0.03767 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.03it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.78it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.03it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.46it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.42it/s]                                                                                                    2.30 seconds
tensor([ 60,   2,   3, 159], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.04it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 11 | Train loss: 0.07253 | Validation loss: 0.03404 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.10it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.96it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.87it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.99it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.25 seconds
tensor([ 69,   4,   2, 149], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 12 | Train loss: 0.06857 | Validation loss: 0.03282 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.64it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.55it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.44it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.07it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.37 seconds
tensor([ 63,   3,   3, 155], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 13 | Train loss: 0.06843 | Validation loss: 0.02724 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.09it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.34it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.37it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.15it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.82it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.27 seconds
tensor([ 62,   2,   6, 154], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 14 | Train loss: 0.05978 | Validation loss: 0.02507 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.20it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.03it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.41it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.20 seconds
tensor([ 28,   5,   6, 185], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 15 | Train loss: 0.06102 | Validation loss: 0.03452 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.91it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.12it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.48it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.90it/s]                                                                                                    2.33 seconds
tensor([ 33,   2,   1, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 16 | Train loss: 0.06631 | Validation loss: 0.03065 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.02it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.34 seconds
tensor([ 51,   3,   3, 167], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 17 | Train loss: 0.06937 | Validation loss: 0.03634 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.22it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.86it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.96it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.32 seconds
tensor([ 34,   6,   4, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 18 | Train loss: 0.06023 | Validation loss: 0.02099 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.09it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.62it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.88it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.91it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.76it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.23it/s]                                                                                                    2.31 seconds
tensor([ 36,   7,   2, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 19 | Train loss: 0.04842 | Validation loss: 0.02118 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.25it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.66it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.83it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.01it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.25it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.27 seconds
tensor([ 36,   5,   3, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 20 | Train loss: 0.04462 | Validation loss: 0.02088 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.10it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.84it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.53it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.85it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.30 seconds
tensor([ 38,   7,   3, 176], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 21 | Train loss: 0.04060 | Validation loss: 0.01543 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.11it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.63it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.48it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.56it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.40it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.89it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.90it/s]                                                                                                    2.31 seconds
tensor([ 40,   2,   4, 178], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 22 | Train loss: 0.03799 | Validation loss: 0.03345 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.36it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.77it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.31 seconds
tensor([ 33,   2,   1, 188], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 23 | Train loss: 0.04287 | Validation loss: 0.04444 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.97it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.70it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.85it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.88it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.41 seconds
tensor([ 42,   5,   2, 175], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 24 | Train loss: 0.03839 | Validation loss: 0.01969 | Validation acc: 100.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.03it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.89it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.95it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.37 seconds
tensor([ 49,   4,   2, 169], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 25 | Train loss: 0.04039 | Validation loss: 0.00942 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.09it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.62it/s]                                                                                                    tensor([  0,   0,   0, 112], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.54it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.75it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.48it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.01it/s]                                                                                                    2.28 seconds
tensor([ 37,   4,   4, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 26 | Train loss: 0.03529 | Validation loss: 0.02036 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.53it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.95it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.42it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.61it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.17 seconds
tensor([ 29,   3,   7, 185], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 27 | Train loss: 0.02752 | Validation loss: 0.05031 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.60it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.73it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.35 seconds
tensor([ 35,   5,   4, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.05it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 28 | Train loss: 0.02884 | Validation loss: 0.02268 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.06it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.00it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.71it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.83it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.93it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.39 seconds
tensor([ 38,   3,   2, 181], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 29 | Train loss: 0.03599 | Validation loss: 0.02237 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.63it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.38it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.28it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.83it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.99it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.26 seconds
tensor([ 40,   2,   4, 178], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 30 | Train loss: 0.02527 | Validation loss: 0.08907 | Validation acc: 88.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.76it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.13it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.35 seconds
tensor([ 36,   4,   1, 183], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 31 | Train loss: 0.01872 | Validation loss: 0.14009 | Validation acc: 84.6
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.29it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.34it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.86it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.92it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.34 seconds
tensor([ 39,   1,   5, 179], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 32 | Train loss: 0.02157 | Validation loss: 0.06484 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.26it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.20it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.74it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.02it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.32 seconds
tensor([ 34,  10,   2, 178], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 33 | Train loss: 0.01984 | Validation loss: 0.18747 | Validation acc: 80.8
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.02it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.06it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.19it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.24it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.28 seconds
tensor([ 42,   1,   3, 178], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 34 | Train loss: 0.02599 | Validation loss: 0.02090 | Validation acc: 96.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.76it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.23it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.08it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.77it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.48it/s]                                                                                                    2.23 seconds
tensor([ 40,   3,   1, 180], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0, 52], device='cuda:0')
Epoch 35 | Train loss: 0.01632 | Validation loss: 0.06177 | Validation acc: 92.3
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=40 perturb_router=True topk=1 random_seed=42
Test result | Loss : 98.2 | Score : 85.7
Took 1.73 minutes for training
Took 2.32 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3088.60it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2740.27it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2958.39it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 76800
prompt_encoder.router.0.weight 7680
trainable params: 84480 || all params: 222966528 || trainable%: 0.03788909517396261
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:08,  1.34s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.45it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.57it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.70it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.89it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.98it/s]                                                                                                    3.03 seconds
tensor([ 0,  0, 24, 26,  7, 64, 94,  1,  3,  5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.06it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.16157 | Validation loss: 0.08060 | Validation acc: 92.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.98it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.08it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 82.1
tensor([  0,   0,   0,   0,   0,   0, 112,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.37it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.84it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.33 seconds
tensor([  1,   0,   1,  51,   6,   3,  45,   0, 104,  13], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 2 | Train loss: 0.10389 | Validation loss: 0.05750 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.92it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.04it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 85.7
tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.10it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.07it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.07it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.85it/s]                                                                                                    2.38 seconds
tensor([  0,   0,   1,  53,   1,   1,   6,   1, 155,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 3 | Train loss: 0.08862 | Validation loss: 0.03338 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.99it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.07it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.78it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.31it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.30it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.35it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.25it/s]                                                                                                    2.25 seconds
tensor([  0,   0,   0,  58,   4,   0,   4,   0, 154,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 4 | Train loss: 0.07961 | Validation loss: 0.05218 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.48it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.41it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.93it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.02it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.35 seconds
tensor([  0,   0,   8,  61,   0,   3,   9,   0, 139,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 5 | Train loss: 0.18525 | Validation loss: 0.05027 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.57it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.93it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.74it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.81it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.00it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.36 seconds
tensor([  0,   0,   4, 100,   0,   0,   3,   0, 108,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0, 24,  0,  0,  0,  0, 28,  0], device='cuda:0')
Epoch 6 | Train loss: 0.07366 | Validation loss: 0.05180 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.58it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.45it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.79it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.85it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.62it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.47it/s]                                                                                                    2.24 seconds
tensor([  0,   0,  12,  98,   1,   0,   4,   0, 103,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 26,  0,  0,  0,  0, 26,  0], device='cuda:0')
Epoch 7 | Train loss: 0.07666 | Validation loss: 0.03679 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.45it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.20it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.54it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.65it/s]                                                                                                    2.15 seconds
tensor([  0,   0,   5,  91,   0,   1,   3,   0, 115,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0, 24,  0,  0,  0,  0, 28,  0], device='cuda:0')
Epoch 8 | Train loss: 0.06988 | Validation loss: 0.03687 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.62it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.35 seconds
tensor([  0,   0,  13, 100,   0,   2,   7,   0,  93,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0, 26,  0,  0,  0,  0, 26,  0], device='cuda:0')
Epoch 9 | Train loss: 0.07430 | Validation loss: 0.03481 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.78it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.00it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.67it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.40it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.28 seconds
tensor([  0,   0,  15,  95,   0,   0,   4,   0, 101,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  4,  0,  0,  0,  0, 48,  0], device='cuda:0')
Epoch 10 | Train loss: 0.06243 | Validation loss: 0.02954 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.92it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.04it/s]                                                                                                    Updating result due to higher validation score
Epoch 10 test result: 89.3
tensor([ 0,  0,  0, 20,  0,  0,  0,  0, 92,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.26it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.18it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.48it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.58it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.07it/s]                                                                                                    2.22 seconds
tensor([  0,   0,  13,  74,   1,   0,   4,   0, 123,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 11 | Train loss: 0.06283 | Validation loss: 0.03075 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.55it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.97it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.11it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.50it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.41it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.27 seconds
tensor([  0,   0,  11,  92,   0,   0,   5,   0, 108,   8], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 12 | Train loss: 0.06126 | Validation loss: 0.03132 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.03it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.69it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.05it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.16it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.25 seconds
tensor([  0,   0,  10,  65,   0,   1,   5,   0, 136,   7], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 13 | Train loss: 0.06063 | Validation loss: 0.02334 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.94it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.05it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.96it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.26it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.87it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.05it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.34 seconds
tensor([  0,   0,   7,  60,   1,   2,   7,   0, 139,   8], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 14 | Train loss: 0.05795 | Validation loss: 0.02290 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.95it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.06it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.06it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.84it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.05it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.28it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.44it/s]                                                                                                    2.24 seconds
tensor([  0,   0,   7,  55,   0,   7,  11,   0, 140,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 15 | Train loss: 0.04983 | Validation loss: 0.03839 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.05it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.88it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.53it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.96it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.14it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    2.20 seconds
tensor([  0,   0,   8,  37,  49,   3,   1,   0, 124,   2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 16 | Train loss: 0.05732 | Validation loss: 0.01894 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.95it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.07it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.48it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.93it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.79it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.55it/s]                                                                                                    2.22 seconds
tensor([  0,   0,   8,  39,  45,   2,   2,   0, 125,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 52,  0], device='cuda:0')
Epoch 17 | Train loss: 0.04959 | Validation loss: 0.01371 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  3.00it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.08it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 112,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.44it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.83it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.29it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.85it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.04it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.22 seconds
tensor([ 0,  0,  4, 18, 99,  1,  6,  0, 94,  2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0, 18,  0,  0,  0, 34,  0], device='cuda:0')
Epoch 18 | Train loss: 0.05869 | Validation loss: 0.01515 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.38it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.30it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.13it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.77it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.05it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.33it/s]                                                                                                    2.24 seconds
tensor([  0,   0,   0,  11, 102,   4,   2,   0, 102,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.20it/s]                                                                                                    tensor([ 0,  0,  0,  0, 28,  0,  0,  0, 24,  0], device='cuda:0')
Epoch 19 | Train loss: 0.05044 | Validation loss: 0.01338 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.94it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.05it/s]                                                                                                    tensor([ 0,  0,  0,  0, 70,  0,  0,  0, 42,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.11it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.19it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.07it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.75it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.17it/s]                                                                                                    2.30 seconds
tensor([  0,   0,   7,   9, 108,   2,   5,   0,  93,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0, 28,  0,  0,  0, 24,  0], device='cuda:0')
Epoch 20 | Train loss: 0.04232 | Validation loss: 0.01227 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.95it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.06it/s]                                                                                                    Patience of score-based early stopping has reached 0. No more updates.
tensor([ 0,  0,  0,  0, 70,  0,  0,  0, 42,  0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.48it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.80it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.99it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.13it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.96it/s]                                                                                                    2.36 seconds
tensor([  1,   0,   7,   8, 108,   1,   4,   0,  90,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.04071 | Validation loss: 0.04576 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.39it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.80it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.73it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.95it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.45it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.29 seconds
tensor([  1,   0,   2,  10, 146,   2,   8,   0,  51,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 22 | Train loss: 0.05293 | Validation loss: 0.01347 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.74it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.86it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.31it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.93it/s]                                                                                                    2.32 seconds
tensor([  0,   3,   6,   6, 142,   3,   6,   1,  52,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 23 | Train loss: 0.06730 | Validation loss: 0.05292 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.04it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.48it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.93it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.24it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.25 seconds
tensor([  0,   3,   5,   7, 139,   5,   3,   2,  58,   2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 24 | Train loss: 0.06691 | Validation loss: 0.02990 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.57it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.18it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.83it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.00it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.19it/s]                                                                                                    2.33 seconds
tensor([  0,   1,   7,   7, 147,   2,   3,   1,  45,  11], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 25 | Train loss: 0.05587 | Validation loss: 0.04002 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.59it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.37it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.20it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.86it/s]                                                                                                    2.31 seconds
tensor([  0,   3,   7,   4, 143,   3,   7,   2,  50,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 26 | Train loss: 0.04978 | Validation loss: 0.03631 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.97it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.12it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.72it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.03it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.00it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.38it/s]                                                                                                    2.17 seconds
tensor([  0,   4,   6,   9, 146,   0,   1,   2,  54,   2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 27 | Train loss: 0.03954 | Validation loss: 0.01215 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.90it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.03it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.44it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.26it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.12it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.80it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.13it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.40it/s]                                                                                                    2.21 seconds
tensor([  1,   2,   6,   9, 155,   3,   4,   1,  37,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 28 | Train loss: 0.03697 | Validation loss: 0.00984 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.93it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.03it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.72it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.97it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.32it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.33it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.90it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.95it/s]                                                                                                    2.36 seconds
tensor([  0,   5,   6,   0, 140,   1,   1,   1,  67,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 29 | Train loss: 0.02929 | Validation loss: 0.04223 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.38it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.20it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.14it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.49it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.02it/s]                                                                                                    2.29 seconds
tensor([  1,   2,   4,   0, 141,   4,   1,   3,  68,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 30 | Train loss: 0.02627 | Validation loss: 0.00718 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.92it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.03it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.68it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.97it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.29 seconds
tensor([  0,   4,   1,   0, 130,   1,   5,   4,  74,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.10it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 31 | Train loss: 0.03888 | Validation loss: 0.01340 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.33it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.50it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.94it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.02it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.22it/s]                                                                                                    2.27 seconds
tensor([  1,   6,   5,   1, 173,   1,   2,   1,  28,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 32 | Train loss: 0.04564 | Validation loss: 0.01296 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.22it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.76it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.42it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.36it/s]                                                                                                    2.25 seconds
tensor([  1,   4,   5,   0, 176,   1,   2,   1,  28,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 33 | Train loss: 0.03077 | Validation loss: 0.00548 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.95it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.05it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.87it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.89it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.01it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.22it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.20it/s]                                                                                                    2.28 seconds
tensor([  0,   3,   7,   1, 165,   2,   5,   2,  34,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 34 | Train loss: 0.03173 | Validation loss: 0.01539 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.66it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.37it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.19it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.14it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.82it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.95it/s]                                                                                                    2.36 seconds
tensor([  0,   5,   1,   0, 174,   0,   2,   1,  36,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 35 | Train loss: 0.01966 | Validation loss: 0.00416 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.96it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.06it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.52it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.25it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.53it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.36it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.95it/s]                                                                                                    2.24 seconds
tensor([  0,   2,   3,   0, 167,   0,   2,   1,  46,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 36 | Train loss: 0.02581 | Validation loss: 0.00387 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.94it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.05it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.76it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.33it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.49it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.31it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.16it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.23it/s]                                                                                                    2.22 seconds
tensor([  0,   2,   4,   0, 168,   1,   3,   1,  40,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 37 | Train loss: 0.02437 | Validation loss: 0.01123 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.64it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.05it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.99it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.54it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.31 seconds
tensor([  1,   4,   4,   0, 163,   2,   2,   0,  45,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 38 | Train loss: 0.01960 | Validation loss: 0.02515 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.67it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.77it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.20it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.21it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.42it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.12 seconds
tensor([  0,   4,   2,   0, 150,   3,   3,   2,  50,  10], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 39 | Train loss: 0.02074 | Validation loss: 0.00418 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.27it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.17it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.79it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.00it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.06it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.34it/s]                                                                                                    2.27 seconds
tensor([  1,   2,   4,   1, 167,   3,   2,   3,  35,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 40 | Train loss: 0.01659 | Validation loss: 0.00571 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.04it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.76it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.27it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.27it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.39it/s]                                                                                                    2.22 seconds
tensor([  0,   3,   6,   1, 165,   6,   0,   0,  37,   6], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 41 | Train loss: 0.03549 | Validation loss: 0.00529 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.80it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.91it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.30it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.26it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.15it/s]                                                                                                    2.31 seconds
tensor([  0,   2,   6,   1, 173,   0,   2,   2,  35,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 42 | Train loss: 0.01943 | Validation loss: 0.00446 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.68it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.46it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.41it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.96it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.16it/s]                                                                                                    2.18 seconds
tensor([  0,   3,   4,   0, 176,   1,   2,   1,  34,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 43 | Train loss: 0.02052 | Validation loss: 0.01946 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.75it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.92it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.23it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.54it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.19it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.18it/s]                                                                                                    2.19 seconds
tensor([  1,   2,   1,   0, 173,   4,   3,   4,  31,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 44 | Train loss: 0.01359 | Validation loss: 0.01263 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.31it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.15it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.04it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.78it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.07it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.27 seconds
tensor([  0,   1,   5,   1, 178,   2,   2,   1,  30,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.08it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 45 | Train loss: 0.01596 | Validation loss: 0.00855 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.31it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.25it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.48it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.59it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.19 seconds
tensor([  1,   2,   2,   0, 174,   6,   1,   2,  33,   3], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.17it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 46 | Train loss: 0.01743 | Validation loss: 0.00364 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.92it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.04it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.40it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.37it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.74it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.09it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.40it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.34it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.70it/s]                                                                                                    2.19 seconds
tensor([  0,   6,   4,   0, 170,   0,   3,   2,  31,   8], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 47 | Train loss: 0.01365 | Validation loss: 0.00359 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.91it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.03it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.99it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.36it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.78it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.97it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.21it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.50it/s]                                                                                                    2.19 seconds
tensor([  1,   2,   5,   0, 176,   1,   5,   2,  28,   4], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 48 | Train loss: 0.00818 | Validation loss: 0.00313 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.93it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.04it/s]                                                                                                    tensor([  0,   0,   0,   0, 112,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.57it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.89it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.46it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.44it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.98it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.29it/s]                                                                                                    2.20 seconds
tensor([  0,   5,   4,   1, 178,   3,   1,   3,  20,   9], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 49 | Train loss: 0.01467 | Validation loss: 0.00345 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.18it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.63it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.85it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.30it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.46it/s]                                                                                                    2.25 seconds
tensor([  0,   2,   4,   0, 168,   2,   2,   4,  37,   5], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0, 52,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 50 | Train loss: 0.00892 | Validation loss: 0.00340 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Test result | Loss : 94.6 | Score : 89.3
Took 2.41 minutes for training
Took 2.28 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=200 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/224 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 224/224 [00:00<00:00, 3089.35it/s]
Formatting dataset:   0%|                                                    | 0/26 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 2666.50it/s]
Formatting dataset:   0%|                                                    | 0/56 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 56/56 [00:00<00:00, 2930.96it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 153600
prompt_encoder.router.0.weight 15360
trainable params: 168960 || all params: 223051008 || trainable%: 0.07574948955173517
Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:  14%|████████▎                                                 | 1/7 [00:01<00:06,  1.16s/it]Train:  29%|████████████████▌                                         | 2/7 [00:01<00:03,  1.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:02,  1.81it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:02<00:01,  2.16it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:02<00:00,  2.66it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.75it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  3.10it/s]                                                                                                    3.04 seconds
tensor([ 2, 37,  3,  0, 11,  0,  0,  0, 17, 58,  1,  0,  2,  9,  0,  2,  0, 53,
         0, 29], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.07it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.14156 | Validation loss: 0.05252 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.15it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.66it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 82.1
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.71it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.64it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.51it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.45it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.25it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.89it/s]                                                                                                    2.27 seconds
tensor([  0,  12,   3,   0,   0,   0,  71,   0,   0, 132,   0,   0,   1,   0,
          0,   0,   0,   3,   1,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.11991 | Validation loss: 8.55833 | Validation acc: 0.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.42it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.85it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.04it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.00it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.08it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.27 seconds
tensor([  0,   0,   6,   0,   0,   0, 132,   0,   0,  81,   1,   0,   0,   0,
          0,   0,   0,   1,   2,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.11it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 1.58458 | Validation loss: 0.04263 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.12it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.64it/s]                                                                                                    Updating result due to higher validation score
Epoch 3 test result: 87.5
tensor([  0,   0,   0,   0,   0,   0, 112,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.79it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.94it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.27it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.20it/s]                                                                                                    2.28 seconds
tensor([ 0,  0, 18,  0,  1,  0, 97,  0,  0, 99,  0,  0,  0,  0,  0,  0,  0,  3,
         4,  2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.08683 | Validation loss: 0.04117 | Validation acc: 96.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.64it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.51it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.98it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.14it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.55it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.67it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.44it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.00it/s]                                                                                                    2.25 seconds
tensor([  0,   0,   6,   0,   0,   0,   9,   0,   0, 106,   0,   0,  96,   0,
          0,   0,   0,   1,   4,   2], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 26,  0,  0, 26,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.10969 | Validation loss: 0.05811 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.13it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.02it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.30it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.25it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.86it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.24it/s]                                                                                                    2.24 seconds
tensor([  0,   0,   7,   0,   0,   0,   3,   0,   0,  89,   0,   0, 118,   0,
          0,   0,   0,   6,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.08692 | Validation loss: 0.05073 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.15it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.66it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.00it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.98it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.37it/s]                                                                                                    2.21 seconds
tensor([  0,   0,   2,   0,   0,   0,   3,   0,   0,  46,   0,   0, 162,   0,
          0,   0,   0,   7,   3,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.08383 | Validation loss: 0.05952 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.15it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.01it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.09it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.08it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.78it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  2.95it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.35 seconds
tensor([  0,   0,   0,   0,   0,   0,   5,   0,   0,  55,   0,   0, 145,   0,
          0,   0,   0,  14,   4,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.07950 | Validation loss: 0.03381 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.65it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.79it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.95it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.94it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.10it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.15it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.55it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.29 seconds
tensor([  0,   0,   5,   0,   0,   0,  10,   0,   0,  58,   0,   0, 133,   0,
          0,   0,   0,  16,   2,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.21it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.06351 | Validation loss: 0.02274 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.64it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.51it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.69it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.06it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.06it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:02<00:00,  3.17it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.32it/s]                                                                                                    2.31 seconds
tensor([  0,   0,   2,   0,   0,   0,   2,   0,   0,  45,   0,   0, 163,   0,
          0,   0,   0,  12,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.06899 | Validation loss: 0.02685 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.96it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.09it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.24it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.83it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.15it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.08it/s]                                                                                                    2.31 seconds
tensor([  0,   0,   1,   0,   0,   0,   1,   0,   0,  47,   0,   0, 159,   0,
          0,   0,   0,  13,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.09it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.05966 | Validation loss: 0.03223 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.65it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.18it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.57it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.89it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.12it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.10it/s]                                                                                                    2.28 seconds
tensor([  0,   0,   0,   0,   0,   0,   4,   0,   0,  58,   0,   0, 154,   0,
          0,   0,   0,   8,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.06111 | Validation loss: 0.03810 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.29it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.43it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.98it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.11it/s]                                                                                                    2.26 seconds
tensor([  0,   0,   1,   0,   0,   0,   0,   0,   0,  62,   0,   0, 147,   0,
          0,   0,   0,  13,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.16it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.04271 | Validation loss: 0.05570 | Validation acc: 92.3
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.10it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.53it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.66it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.09it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.04it/s]                                                                                                    2.27 seconds
tensor([  0,   0,   0,   0,   0,   0,   2,   0,   0,  38,   0,   0, 166,   0,
          0,   0,   0,  15,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.05144 | Validation loss: 0.01279 | Validation acc: 100.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/2 [00:00<?, ?it/s]Test:  50%|█████████████████████████████▌                             | 1/2 [00:00<00:00,  2.13it/s]Test: 100%|███████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.65it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.94it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.15it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.35it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.37it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.94it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.02it/s]                                                                                                    2.32 seconds
tensor([  0,   0,   1,   0,   0,   0,   1,   0,   0,  61,   0,   0, 144,   0,
          0,   0,   0,  14,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.15it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.05229 | Validation loss: 0.01772 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.69it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:02,  2.49it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.98it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.23it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.17it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.51it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.30it/s]                                                                                                    2.25 seconds
tensor([  0,   0,   4,   0,   0,   1,   4,   0,   0,  34,   0,   0, 162,   2,
          0,   0,   0,  16,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.13it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.04394 | Validation loss: 0.01567 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.83it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.54it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  2.71it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.90it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.32it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.23it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.30 seconds
tensor([  0,   0,   2,   0,   0,   0,   2,   0,   0,   0,   0,   0, 171,  42,
          0,   0,   0,   7,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.03487 | Validation loss: 0.01778 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.73it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.44it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.62it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.38it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.31it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.92it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.93it/s]                                                                                                    2.30 seconds
tensor([  0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0, 176,  40,
          0,   0,   0,   7,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.14it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.04108 | Validation loss: 0.01467 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.49it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.35it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.21it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.82it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.94it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.03it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.14it/s]                                                                                                    2.32 seconds
tensor([  0,   0,   2,   7,   0,   0,   2,   0,   0,   1,   0,   0, 159,  48,
          0,   0,   0,   4,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.03247 | Validation loss: 0.07092 | Validation acc: 92.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.07it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.85it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.40it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.42it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.23it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.37it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.26it/s]                                                                                                    2.23 seconds
tensor([  0,   0,   0,  38,   0,   0,   1,   0,   1,   0,   0,   0, 162,  20,
          0,   0,   0,   2,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.18it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.02768 | Validation loss: 0.03210 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.47it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.60it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.34it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:01,  2.87it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.18it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.10it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.13it/s]                                                                                                    2.25 seconds
tensor([  0,   0,   0,  43,   0,   0,   0,   0,   0,   0,   0,   0, 144,  32,
          0,   0,   0,   4,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.12it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.02641 | Validation loss: 0.03457 | Validation acc: 96.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:03,  1.98it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  2.57it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:01<00:01,  3.11it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.20it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.10it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  3.33it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.28it/s]                                                                                                    2.29 seconds
tensor([  0,   1,   0,  37,   0,   0,   2,   0,   0,   0,   0,   0, 157,  24,
          0,   0,   0,   3,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 22 | Train loss: 0.03349 | Validation loss: 0.02383 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:01,  3.33it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.28it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.33it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.17it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  2.83it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.94it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.06it/s]                                                                                                    2.31 seconds
tensor([  0,   0,   1,  46,   0,   0,   1,   0,   0,   1,   0,   0, 146,  24,
          0,   0,   0,   5,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 23 | Train loss: 0.03237 | Validation loss: 0.02927 | Validation acc: 100.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                  | 0/7 [00:00<?, ?it/s]Train:  14%|████████▎                                                 | 1/7 [00:00<00:02,  2.62it/s]Train:  29%|████████████████▌                                         | 2/7 [00:00<00:01,  3.32it/s]Train:  43%|████████████████████████▊                                 | 3/7 [00:00<00:01,  3.57it/s]Train:  57%|█████████████████████████████████▏                        | 4/7 [00:01<00:00,  3.50it/s]Train:  71%|█████████████████████████████████████████▍                | 5/7 [00:01<00:00,  3.28it/s]Train:  86%|█████████████████████████████████████████████████▋        | 6/7 [00:01<00:00,  2.90it/s]Train: 100%|██████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.12it/s]                                                                                                    2.24 seconds
tensor([  0,   0,   0,  57,   0,   0,   0,   0,   0,   0,   0,   0, 144,  20,
          0,   0,   0,   3,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/1 [00:00<?, ?it/s]Validation: 100%|█████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 52,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 24 | Train loss: 0.02652 | Validation loss: 0.03092 | Validation acc: 96.2
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=200 perturb_router=True topk=1 random_seed=42
Test result | Loss : 92.9 | Score : 87.5
Took 1.15 minutes for training
Took 2.31 seconds per epoch
