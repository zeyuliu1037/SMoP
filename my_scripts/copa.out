lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=2 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 4358.83it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6041.54it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6054.48it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 1536
prompt_encoder.router.0.weight 1536
trainable params: 3072 || all params: 222885120 || trainable%: 0.0013782885102424066
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:19,  1.80s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:04,  1.90it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:02<00:02,  3.40it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:02<00:01,  4.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:02<00:00,  6.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:02<00:00,  7.93it/s]                                                                                                    2.64 seconds
tensor([296,  63], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  4.57it/s]                                                                                                    tensor([82,  0], device='cuda:0')
Epoch 1 | Train loss: 0.30217 | Validation loss: 0.22861 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.95it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.15it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 53.0
tensor([200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.24it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.71it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.80it/s]                                                                                                    1.01 seconds
tensor([333,  26], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([82,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26392 | Validation loss: 0.23581 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.51it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.80it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.38it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.71it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.00it/s]                                                                                                    1.00 seconds
tensor([ 84, 275], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.27290 | Validation loss: 0.23692 | Validation acc: 53.7
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.47it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.70it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.74it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.03it/s]                                                                                                    1.00 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  4.73it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.26652 | Validation loss: 0.22482 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.73it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.06it/s]                                                                                                    Updating result due to higher validation score
Epoch 4 test result: 53.0
tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.02it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.11it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.63it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.20it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.59it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    1.01 seconds
tensor([ 29, 330], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.03it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 5 | Train loss: 0.26917 | Validation loss: 0.23059 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.70it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.98it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.58it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.78it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.94it/s]                                                                                                    0.99 seconds
tensor([ 27, 332], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.75it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 6 | Train loss: 0.25255 | Validation loss: 0.22938 | Validation acc: 53.7
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.88it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.49it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.94it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.18it/s]                                                                                                    0.98 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 7 | Train loss: 0.24895 | Validation loss: 0.23099 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.28it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.81it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.93it/s]                                                                                                    1.00 seconds
tensor([ 25, 334], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 8 | Train loss: 0.25202 | Validation loss: 0.22262 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.68it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.02it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.44it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.90it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.12it/s]                                                                                                    0.99 seconds
tensor([ 27, 332], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 9 | Train loss: 0.25375 | Validation loss: 0.22574 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.77it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.81it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.87it/s]                                                                                                    0.99 seconds
tensor([ 20, 339], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 10 | Train loss: 0.25928 | Validation loss: 0.22541 | Validation acc: 53.7
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.66it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.93it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.53it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.78it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.04it/s]                                                                                                    0.98 seconds
tensor([ 29, 330], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 11 | Train loss: 0.26423 | Validation loss: 0.22965 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.89it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.76it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.04it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.23it/s]                                                                                                    0.97 seconds
tensor([ 18, 341], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 12 | Train loss: 0.25474 | Validation loss: 0.22880 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.50it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.90it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.49it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.81it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.99it/s]                                                                                                    0.98 seconds
tensor([ 32, 327], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.94it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 13 | Train loss: 0.24439 | Validation loss: 0.22384 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 13 test result: 55.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.72it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.59it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.05it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.13it/s]                                                                                                    0.97 seconds
tensor([ 29, 330], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 14 | Train loss: 0.25652 | Validation loss: 0.22624 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.74it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.01it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.86it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.13it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.49it/s]                                                                                                    0.96 seconds
tensor([ 29, 330], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.94it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 15 | Train loss: 0.26456 | Validation loss: 0.22498 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.78it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.68it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.11it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.26it/s]                                                                                                    0.97 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 16 | Train loss: 0.25531 | Validation loss: 0.22775 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.69it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.11it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.59it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.01it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.30it/s]                                                                                                    0.97 seconds
tensor([ 40, 319], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 17 | Train loss: 0.25551 | Validation loss: 0.22888 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.71it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.97it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.58it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.99it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.20it/s]                                                                                                    0.98 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 18 | Train loss: 0.26157 | Validation loss: 0.22479 | Validation acc: 56.1
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.77it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.88it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.61it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.33it/s]                                                                                                    0.97 seconds
tensor([ 30, 329], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 19 | Train loss: 0.25773 | Validation loss: 0.22675 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.76it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.49it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.97it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.27it/s]                                                                                                    0.98 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.91it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 20 | Train loss: 0.26952 | Validation loss: 0.22542 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.69it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.89it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.31it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 13.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.38it/s]                                                                                                    0.96 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 21 | Train loss: 0.25373 | Validation loss: 0.22586 | Validation acc: 65.9
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.62it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.94it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.58it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.03it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.41it/s]                                                                                                    0.96 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.10it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 22 | Train loss: 0.25066 | Validation loss: 0.22473 | Validation acc: 65.9
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.90it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.77it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.12it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.65it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.01it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.26it/s]                                                                                                    0.97 seconds
tensor([ 27, 332], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.96it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 23 | Train loss: 0.24778 | Validation loss: 0.22398 | Validation acc: 58.5
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=2 perturb_router=True topk=1 random_seed=42
Test result | Loss : 55.0 | Score : 55.0
Took 0.53 minutes for training
Took 1.05 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=4 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5854.75it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5093.19it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6035.93it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 3072
prompt_encoder.router.0.weight 3072
trainable params: 6144 || all params: 222888192 || trainable%: 0.002756539027424118
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.01it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.18it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.23it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  7.10it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.83it/s]                                                                                                    1.83 seconds
tensor([ 25, 139,  38, 157], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.39it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.27468 | Validation loss: 0.22282 | Validation acc: 68.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.65it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.14it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 55.0
tensor([  0, 200,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  7.00it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.52it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.74it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.50it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.90it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.06it/s]                                                                                                    0.99 seconds
tensor([ 14, 276,  48,  21], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26566 | Validation loss: 0.22476 | Validation acc: 63.4
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.82it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.35it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.76it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.87it/s]                                                                                                    1.00 seconds
tensor([ 10, 269,   9,  71], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.79it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.25743 | Validation loss: 0.22244 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.82it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.16it/s]                                                                                                    tensor([  0, 200,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.79it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.52it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.40it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.68it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.04it/s]                                                                                                    0.99 seconds
tensor([ 12, 300,  13,  34], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.26546 | Validation loss: 0.22850 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.95it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.58it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.97it/s]                                                                                                    0.99 seconds
tensor([ 44, 291,  16,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.01it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.25709 | Validation loss: 0.23475 | Validation acc: 51.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.86it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.61it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.32it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.84it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.04it/s]                                                                                                    0.99 seconds
tensor([148, 195,   6,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.29170 | Validation loss: 0.24098 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.65it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.88it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.46it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.62it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.92it/s]                                                                                                    1.00 seconds
tensor([187, 159,   9,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.72it/s]                                                                                                    tensor([52, 30,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.25267 | Validation loss: 0.23814 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.57it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.76it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.36it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.92it/s]                                                                                                    1.00 seconds
tensor([169, 175,  11,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.63it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.25373 | Validation loss: 0.23113 | Validation acc: 65.9
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.85it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.47it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.71it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.89it/s]                                                                                                    0.99 seconds
tensor([ 50, 290,   9,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.27323 | Validation loss: 0.22713 | Validation acc: 63.4
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.78it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.88it/s]                                                                                                    1.00 seconds
tensor([ 34, 294,  19,  12], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.98it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25728 | Validation loss: 0.23328 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.51it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.91it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.38it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    1.00 seconds
tensor([ 48, 284,  14,  13], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.24788 | Validation loss: 0.23324 | Validation acc: 58.5
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.57it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.67it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.36it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.88it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.99it/s]                                                                                                    0.99 seconds
tensor([ 38, 301,  12,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.26127 | Validation loss: 0.22870 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.55it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.88it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.65it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    1.00 seconds
tensor([ 29, 303,  12,  15], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.00it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.25605 | Validation loss: 0.23016 | Validation acc: 48.8
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=4 perturb_router=True topk=1 random_seed=42
Test result | Loss : 55.0 | Score : 55.0
Took 0.30 minutes for training
Took 1.06 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5816.38it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5998.55it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6007.74it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 7680
prompt_encoder.router.0.weight 7680
trainable params: 15360 || all params: 222897408 || trainable%: 0.006891062636313833
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.06it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  7.22it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.66it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.91it/s]                                                                                                    1.79 seconds
tensor([133, 119,   2,  10,  56,   7,  12,  14,   2,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.19it/s]                                                                                                    tensor([ 0, 82,  0,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.26323 | Validation loss: 0.21606 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.92it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.26it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 54.0
tensor([  0, 200,   0,   0,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.85it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.40it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.66it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.94it/s]                                                                                                    0.99 seconds
tensor([  0, 173,  13, 134,   1,   0,   0,  38,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.99it/s]                                                                                                    tensor([ 0, 54,  0, 28,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26354 | Validation loss: 0.22741 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.32it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.95it/s]                                                                                                    1.00 seconds
tensor([  0, 156,  16, 137,   2,   0,  26,  22,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.83it/s]                                                                                                    tensor([ 0, 80,  0,  2,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.25636 | Validation loss: 0.21637 | Validation acc: 68.3
Updating result due to higher validation score
Epoch 3 test result: 54.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.85it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.79it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.95it/s]                                                                                                    0.99 seconds
tensor([  0, 129,   5,  67,   0,   0, 145,  13,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.83it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.26185 | Validation loss: 0.22811 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  7.01it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.76it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.52it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.71it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.96it/s]                                                                                                    0.98 seconds
tensor([  0,  47,   1,  14,   0, 130, 165,   1,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 12, 70,  0,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.27392 | Validation loss: 0.22222 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.44it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.98it/s]                                                                                                    0.99 seconds
tensor([  0,  48,   0,  13,   0, 140, 156,   2,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.99it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 12, 70,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25787 | Validation loss: 0.21790 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.82it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.70it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.84it/s]                                                                                                    1.00 seconds
tensor([  0,  48,   2,   5,   0, 140, 164,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 12, 70,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.27179 | Validation loss: 0.22252 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.15it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.01it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.44it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.09it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.85it/s]                                                                                                    1.02 seconds
tensor([  0,  46,   1,   6,   0, 144, 161,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.82it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  2, 80,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.25069 | Validation loss: 0.21824 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.89it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.81it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.45it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.71it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.86it/s]                                                                                                    0.99 seconds
tensor([  0,  42,   1,   4,   0, 152, 160,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  2, 80,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25947 | Validation loss: 0.22200 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.67it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.27it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.39it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.73it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    0.99 seconds
tensor([  0,  51,   1,   8,   0, 132, 166,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.00it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  2, 80,  0,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25175 | Validation loss: 0.22142 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.95it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.74it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.98it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.47it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.83it/s]                                                                                                    0.99 seconds
tensor([  0,  62,   2,   9,   0, 125, 161,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.91it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 70, 12,  0,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.25121 | Validation loss: 0.21829 | Validation acc: 53.7
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.33it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.84it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.81it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 13.08it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.22it/s]                                                                                                    0.97 seconds
tensor([  1,  35,   1,  13,   0, 158, 149,   1,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.85it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0, 56, 26,  0,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.27556 | Validation loss: 0.22112 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.40it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 12.17it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.59it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.96it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.32it/s]                                                                                                    0.97 seconds
tensor([  0,  29,   2,  16,   0, 157, 153,   0,   0,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.01it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.25242 | Validation loss: 0.23186 | Validation acc: 61.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Test result | Loss : 54.0 | Score : 54.0
Took 0.29 minutes for training
Took 1.05 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5601.60it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5863.56it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 5916.89it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 15360
trainable params: 30720 || all params: 222912768 || trainable%: 0.01378117560318483
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.03it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  7.12it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.75it/s]                                                                                                    1.81 seconds
tensor([  3,   3,   6,   3,   2,   1,   1,   4,   3,   3,   1,  64, 143,  22,
          1,  56,   2,  19,  16,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.19it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 68,  0,  0, 14,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.27586 | Validation loss: 0.22578 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.65it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.03it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 51.0
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 162,   0,
          0,  38,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.79it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.44it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.68it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.88it/s]                                                                                                    1.00 seconds
tensor([  0,   1,   0,   0,   0,   0,   0,   0,   0,   2,   0,  24, 101,   0,
        102, 129,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.61it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26989 | Validation loss: 0.23183 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.86it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.49it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    0.99 seconds
tensor([  0,   2,   0,   0,   0,   0,   0,   1,   0,   0,   1,  16,  67,   0,
        264,   7,   0,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.26443 | Validation loss: 0.24695 | Validation acc: 58.5
Updating result due to higher validation score
Epoch 3 test result: 51.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.53it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.21it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.82it/s]                                                                                                    1.00 seconds
tensor([  0,   0,   1,   0,   0,   0,   0,   0,   0,   4,   7,   4,  92,   6,
        242,   3,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.25249 | Validation loss: 0.22884 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 4 test result: 51.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.53it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.33it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.62it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.81it/s]                                                                                                    1.01 seconds
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,  60,  23,
        273,   2,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.85it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.26167 | Validation loss: 0.22767 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.61it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.20it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.92it/s]                                                                                                    1.00 seconds
tensor([  0,   0,   0,   0,   0,   3,   0,   0,   0,  25,   4,   4, 159,  33,
        125,   6,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.26204 | Validation loss: 0.24856 | Validation acc: 51.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.67it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.39it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.72it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.88it/s]                                                                                                    1.00 seconds
tensor([  0,   0,   5,   0,   0,   4,   0,   0,   0, 289,   2,   2,  18,  37,
          0,   1,   0,   1,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.58it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.25364 | Validation loss: 0.22837 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.87it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.75it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.32it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.50it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.78it/s]                                                                                                    1.00 seconds
tensor([  0,   0,   4,   0,   0,  12,   0,   0,   0, 277,   2,   2,   0,  56,
          4,   0,   0,   2,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.26535 | Validation loss: 0.22589 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.72it/s]                                                                                                    1.01 seconds
tensor([  0,   0,  68,   0,   0,  12,   0,   0,   0, 253,   1,   0,   0,  17,
          6,   1,   0,   1,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.95it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.27250 | Validation loss: 0.22749 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.85it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.69it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.98it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.49it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.75it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.77it/s]                                                                                                    1.00 seconds
tensor([  0,   1,  83,   0,   0,   9,   0,   0,   1, 245,   2,   1,   1,   6,
          7,   2,   0,   0,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25428 | Validation loss: 0.23182 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.66it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.33it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.49it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.70it/s]                                                                                                    1.01 seconds
tensor([  0,   0,  86,   0,   0,   7,   0,   1,   0, 237,   1,   1,   1,  19,
          5,   0,   0,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.26500 | Validation loss: 0.23071 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.73it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.28it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.62it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.82it/s]                                                                                                    1.00 seconds
tensor([  0,   1,  81,   0,   0,   9,   0,   0,   0, 242,   0,   1,   0,  20,
          5,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.81it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.25368 | Validation loss: 0.23160 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.60it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.91it/s]                                                                                                    1.00 seconds
tensor([  0,   0,  80,   0,   0,   4,   0,   1,   0, 238,   0,   0,   0,  33,
          2,   0,   0,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.26287 | Validation loss: 0.22913 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.50it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.23it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.62it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.86it/s]                                                                                                    1.00 seconds
tensor([  0,   0,  79,   0,   0,   4,   0,   0,   0, 231,   0,   0,   1,  40,
          4,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.66it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.27729 | Validation loss: 0.22861 | Validation acc: 56.1
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=1 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 51.0 | Score : 51.0
Took 0.32 minutes for training
Took 1.06 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=6 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5732.10it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6110.02it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6085.85it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 4608
prompt_encoder.router.0.weight 1536
trainable params: 6144 || all params: 222888192 || trainable%: 0.002756539027424118
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.05it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  7.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.57it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.70it/s]                                                                                                    1.82 seconds
tensor([288,  71], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.12it/s]                                                                                                    tensor([ 6, 76], device='cuda:0')
Epoch 1 | Train loss: 0.30639 | Validation loss: 0.22149 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.56it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.88it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 57.0
tensor([  4, 196], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.65it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.61it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.01 seconds
tensor([ 37, 322], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 2 | Train loss: 0.31901 | Validation loss: 0.27985 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.66it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.02 seconds
tensor([ 25, 334], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.30286 | Validation loss: 0.26114 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.12it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.50it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.59it/s]                                                                                                    1.02 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.54it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.26789 | Validation loss: 0.25979 | Validation acc: 48.8
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.51it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.02 seconds
tensor([ 27, 332], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.82it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 5 | Train loss: 0.26276 | Validation loss: 0.22583 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.63it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.23it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.48it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.59it/s]                                                                                                    1.01 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 6 | Train loss: 0.24521 | Validation loss: 0.22387 | Validation acc: 63.4
Updating result due to higher validation score
Epoch 6 test result: 57.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.77it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.22it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.35it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.12it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.50it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([ 36, 323], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.91it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 7 | Train loss: 0.24788 | Validation loss: 0.22033 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.54it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.83it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.80it/s]                                                                                                    1.00 seconds
tensor([ 24, 335], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 8 | Train loss: 0.25415 | Validation loss: 0.22422 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.51it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.42it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.63it/s]                                                                                                    1.01 seconds
tensor([ 21, 338], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 9 | Train loss: 0.25667 | Validation loss: 0.22334 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.85it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.17it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.77it/s]                                                                                                    1.01 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 10 | Train loss: 0.26042 | Validation loss: 0.22210 | Validation acc: 63.4
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.45it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.02it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.48it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.01 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.82it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 11 | Train loss: 0.26331 | Validation loss: 0.22862 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.29it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.01it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.21it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.01 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.79it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 12 | Train loss: 0.25512 | Validation loss: 0.22503 | Validation acc: 53.7
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.59it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.50it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.66it/s]                                                                                                    1.01 seconds
tensor([ 22, 337], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.54it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 13 | Train loss: 0.25520 | Validation loss: 0.21980 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.45it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.78it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.11it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.67it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.71it/s]                                                                                                    1.01 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 14 | Train loss: 0.26408 | Validation loss: 0.22191 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.46it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.78it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.63it/s]                                                                                                    1.01 seconds
tensor([ 30, 329], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.56it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 15 | Train loss: 0.25499 | Validation loss: 0.22183 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.30it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.24it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.48it/s]                                                                                                    1.02 seconds
tensor([235, 124], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.50it/s]                                                                                                    tensor([82,  0], device='cuda:0')
Epoch 16 | Train loss: 0.24641 | Validation loss: 0.22130 | Validation acc: 61.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.46it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.13it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.35it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.54it/s]                                                                                                    1.02 seconds
tensor([332,  27], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([82,  0], device='cuda:0')
Epoch 17 | Train loss: 0.24826 | Validation loss: 0.21806 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.71it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.91it/s]                                                                                                    tensor([200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.14it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.42it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.01 seconds
tensor([188, 171], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 2, 80], device='cuda:0')
Epoch 18 | Train loss: 0.24892 | Validation loss: 0.22962 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.38it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.17it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.31it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.66it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.95it/s]                                                                                                    1.00 seconds
tensor([ 35, 324], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.73it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 19 | Train loss: 0.25615 | Validation loss: 0.22554 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.57it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.28it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.57it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.75it/s]                                                                                                    1.00 seconds
tensor([ 34, 325], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 20 | Train loss: 0.25623 | Validation loss: 0.22670 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.67it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.90it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.58it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.94it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.00it/s]                                                                                                    0.98 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 21 | Train loss: 0.25396 | Validation loss: 0.22945 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.91it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.55it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.86it/s]                                                                                                    0.99 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 22 | Train loss: 0.23720 | Validation loss: 0.22410 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.62it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.59it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.64it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.42it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.79it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.02it/s]                                                                                                    0.99 seconds
tensor([ 30, 329], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.56it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 23 | Train loss: 0.23342 | Validation loss: 0.22988 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.85it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.87it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.27it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.16it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.52it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.83it/s]                                                                                                    1.01 seconds
tensor([ 37, 322], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.78it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 24 | Train loss: 0.25798 | Validation loss: 0.22693 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.30it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.71it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.35it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.56it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    1.00 seconds
tensor([ 38, 321], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.73it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 25 | Train loss: 0.24669 | Validation loss: 0.22664 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.54it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.71it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.34it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.72it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.90it/s]                                                                                                    1.00 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.75it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 26 | Train loss: 0.24837 | Validation loss: 0.22451 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.55it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.82it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.45it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.74it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.04it/s]                                                                                                    0.99 seconds
tensor([ 35, 324], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 27 | Train loss: 0.24583 | Validation loss: 0.22227 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=6 perturb_router=True topk=1 random_seed=42
Test result | Loss : 60.0 | Score : 57.0
Took 0.61 minutes for training
Took 1.04 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=12 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5820.18it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6041.12it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6046.02it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 9216
prompt_encoder.router.0.weight 3072
trainable params: 12288 || all params: 222894336 || trainable%: 0.005512926088889042
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.01it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.17it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.19it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.59it/s]                                                                                                    1.85 seconds
tensor([192,  29,  88,  50], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.93it/s]                                                                                                    tensor([ 0,  0, 82,  0], device='cuda:0')
Epoch 1 | Train loss: 0.26522 | Validation loss: 0.21259 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.73it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.88it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 53.0
tensor([  0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.15it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.59it/s]                                                                                                    1.02 seconds
tensor([  9,   5, 308,  37], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0, 82,  0], device='cuda:0')
Epoch 2 | Train loss: 0.27232 | Validation loss: 0.24696 | Validation acc: 48.8
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.64it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.07it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.49it/s]                                                                                                    1.02 seconds
tensor([ 11,  53, 168, 127], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.27405 | Validation loss: 0.22524 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.22it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.31it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.59it/s]                                                                                                    1.02 seconds
tensor([ 78, 255,  10,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.75it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.25663 | Validation loss: 0.21020 | Validation acc: 70.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.57it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.73it/s]                                                                                                    Updating result due to higher validation score
Epoch 4 test result: 52.0
tensor([  2, 198,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.30it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.02it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.34it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.02 seconds
tensor([ 36, 297,  10,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.27225 | Validation loss: 0.20380 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.34it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.60it/s]                                                                                                    tensor([  0, 200,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.77it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.95it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.02 seconds
tensor([ 33, 288,  14,  24], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25368 | Validation loss: 0.20596 | Validation acc: 65.9
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.31it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.56it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.54it/s]                                                                                                    1.03 seconds
tensor([ 30, 287,  22,  20], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.24268 | Validation loss: 0.21160 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.69it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.19it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.21it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.57it/s]                                                                                                    1.02 seconds
tensor([ 33, 286,  22,  18], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.52it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.24942 | Validation loss: 0.20898 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.56it/s]                                                                                                    1.02 seconds
tensor([ 28, 297,  18,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.54it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.26906 | Validation loss: 0.21822 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.48it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.24it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.03 seconds
tensor([ 27, 288,   7,  37], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25617 | Validation loss: 0.21755 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.11it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.35it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.02 seconds
tensor([ 10, 248,  15,  86], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0, 80,  0,  2], device='cuda:0')
Epoch 11 | Train loss: 0.24416 | Validation loss: 0.21566 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.10it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.66it/s]                                                                                                    1.02 seconds
tensor([  2, 220,   5, 132], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.46it/s]                                                                                                    tensor([ 0, 80,  0,  2], device='cuda:0')
Epoch 12 | Train loss: 0.25621 | Validation loss: 0.21621 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.24it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.53it/s]                                                                                                    1.02 seconds
tensor([  4, 128,   6, 221], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.47it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 13 | Train loss: 0.26095 | Validation loss: 0.22917 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.10it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.71it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.21it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.51it/s]                                                                                                    1.04 seconds
tensor([  4, 225,   7, 123], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.46it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.24708 | Validation loss: 0.21992 | Validation acc: 58.5
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.32it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.12it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.41it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.61it/s]                                                                                                    1.02 seconds
tensor([  5, 303,   9,  42], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.24510 | Validation loss: 0.21227 | Validation acc: 63.4
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=12 perturb_router=True topk=1 random_seed=42
Test result | Loss : 57.0 | Score : 52.0
Took 0.36 minutes for training
Took 1.08 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=30 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5912.64it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6106.98it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6125.58it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 23040
prompt_encoder.router.0.weight 7680
trainable params: 30720 || all params: 222912768 || trainable%: 0.01378117560318483
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.00it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.15it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.16it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.95it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.57it/s]                                                                                                    1.86 seconds
tensor([65, 95, 51, 15, 75, 27,  4,  0, 12, 15], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.01it/s]                                                                                                    tensor([ 0,  0,  0,  0, 82,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.25823 | Validation loss: 0.21055 | Validation acc: 53.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.87it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00, 10.06it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 60.0
tensor([  0,   0,   0,   0, 200,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.86it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.92it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.31it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.48it/s]                                                                                                    1.04 seconds
tensor([  3,   3,  22,   0, 199,   0,   4,   0, 121,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26695 | Validation loss: 0.21772 | Validation acc: 58.5
Updating result due to higher validation score
Epoch 2 test result: 60.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.68it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.47it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.06it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.02 seconds
tensor([  0,   3,   8,   0, 114,   1,   6,   0, 227,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 3 | Train loss: 0.25629 | Validation loss: 0.22975 | Validation acc: 63.4
Updating result due to higher validation score
Epoch 3 test result: 60.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.77it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.01 seconds
tensor([ 27,  58,   4,   0,  53,   4,   5,   0, 207,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.48it/s]                                                                                                    tensor([ 0, 78,  0,  0,  0,  0,  0,  0,  4,  0], device='cuda:0')
Epoch 4 | Train loss: 0.25749 | Validation loss: 0.21599 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.64it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.46it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.80it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.03it/s]                                                                                                    1.00 seconds
tensor([  0, 202,  29,   0,   0,   0,   5,   0, 123,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([ 0,  0, 72,  0,  0,  0,  0,  0, 10,  0], device='cuda:0')
Epoch 5 | Train loss: 0.26805 | Validation loss: 0.21600 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.51it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.55it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.71it/s]                                                                                                    1.00 seconds
tensor([  1,  10, 183,  20,   0,   1,   3,   1, 140,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0, 82,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.27207 | Validation loss: 0.22186 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.83it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.45it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.73it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.95it/s]                                                                                                    0.99 seconds
tensor([  0,   2, 174,  81,   3,   0,   1,   0,  97,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.72it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.26146 | Validation loss: 0.22705 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.74it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.38it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.68it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.01it/s]                                                                                                    0.99 seconds
tensor([  0,   4,  69, 232,   0,   0,   5,   1,  48,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.66866 | Validation loss: 0.23006 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.71it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.22it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.87it/s]                                                                                                    1.00 seconds
tensor([  1,   7,  12, 260,   0,   0,   5,   3,  71,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25529 | Validation loss: 0.22655 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.54it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.26it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.73it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.93it/s]                                                                                                    1.00 seconds
tensor([  0,   8,   5, 257,   2,   0,   3,   0,  84,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.43it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.26514 | Validation loss: 0.22580 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.80it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.25it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.04it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.33it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.03 seconds
tensor([  2,   7,   1, 266,   3,   1,   0,   3,  76,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.26350 | Validation loss: 0.22767 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.77it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.20it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.53it/s]                                                                                                    1.04 seconds
tensor([  0,   8,   1, 243,   2,   2,   2,  24,  77,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.25908 | Validation loss: 0.23560 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.15it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.56it/s]                                                                                                    1.03 seconds
tensor([  1,   2,   2, 117,   1,   0,   1, 193,  42,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.25673 | Validation loss: 0.22279 | Validation acc: 53.7
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=30 perturb_router=True topk=1 random_seed=42
Test result | Loss : 60.0 | Score : 60.0
Took 0.30 minutes for training
Took 1.08 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=60 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5713.60it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5992.49it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 5991.86it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 46080
prompt_encoder.router.0.weight 15360
trainable params: 61440 || all params: 222943488 || trainable%: 0.027558553313743794
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:11,  1.06s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.01it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.00it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.75it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.37it/s]                                                                                                    1.92 seconds
tensor([  4,   0,   4,   8,   0,   0,   8,   0,   0,   7,  65,   2,   1,   8,
          2,  68, 121,  15,  19,  27], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.26it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.26749 | Validation loss: 0.21244 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.64it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.80it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 53.0
tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0, 200,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.85it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.14it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.49it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.01 seconds
tensor([  0,   0,   0,   0,   0,   0,   0,   1, 237,   0,   1,  10,   0,   0,
          0,  15,  93,   0,   2,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.27123 | Validation loss: 0.21686 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.57it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.28it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.44it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.10it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.56it/s]                                                                                                    1.02 seconds
tensor([  0,   0,   0,   0,   1,   0,   0,  52, 162,   0,   0,  15,   1,   0,
          0,   9, 118,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0,  0, 80,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.26997 | Validation loss: 0.22184 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.44it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.73it/s]                                                                                                    1.01 seconds
tensor([  1,   0,   1,   0, 164,   0,   0, 133,   2,   0,   0,   5,   0,   0,
          0,   2,  51,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.95it/s]                                                                                                    tensor([ 0,  0,  0,  0, 80,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.27275 | Validation loss: 0.21758 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.30it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.62it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([  1,   0,   0,   0,  98,   0,   0, 197,   0,   0,   0,  12,   0,   0,
         10,   1,  40,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.90it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.26829 | Validation loss: 0.21301 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 5 test result: 53.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.65it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.53it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.01 seconds
tensor([  1,   0,   0,   0,  56,   0,   1, 220,   0,   0,   0,   7,   0,   0,
         26,   0,  48,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25703 | Validation loss: 0.21121 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.55it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.75it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.24it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.53it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.02 seconds
tensor([  0,   0,   0,   0,  42,   0,   0, 215,   0,   0,   0,  17,   0,   0,
         25,   1,  59,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.65it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.25632 | Validation loss: 0.20960 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.70it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.84it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.79it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.68it/s]                                                                                                    1.01 seconds
tensor([  2,   0,   0,   0,   3,   0,   0, 208,   1,   0,   0,   9,   0,   0,
         30,   1, 105,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.78it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.25886 | Validation loss: 0.21005 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.02 seconds
tensor([  2,   0,   1,   0,   0,   0,   0, 211,   0,   0,   0,  11,   0,   0,
         35,   2,  97,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.01it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25592 | Validation loss: 0.20980 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.30it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.59it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.59it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.63it/s]                                                                                                    1.01 seconds
tensor([  4,   0,   0,   0,   2,   0,   0, 173,   1,   0,   0,   6,   0,   0,
         30,   0, 143,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.98it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25834 | Validation loss: 0.20555 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.79it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.88it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0, 186,   0,   0,   0,   0,   0,   0,
          0,   0,  14,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.37it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.59it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.01 seconds
tensor([  2,   0,   0,   0,   3,   0,   0, 184,   2,   0,   0,  11,   0,   0,
         25,   1, 131,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.94it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.24582 | Validation loss: 0.20068 | Validation acc: 70.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.70it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.81it/s]                                                                                                    Updating result due to higher validation score
Epoch 11 test result: 55.0
tensor([  0,   0,   0,   0,   0,   0,   0, 186,   0,   0,   0,   0,   0,   0,
          0,   0,  14,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.37it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.02 seconds
tensor([  1,   0,   0,   0,   5,   5,   1, 183,   0,   0,   1,   9,   0,   0,
         29,   0, 125,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.75it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.26485 | Validation loss: 0.20241 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.00it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.98it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.22it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.84it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.03 seconds
tensor([  3,   0,   0,   0,   1,  20,   0, 164,   0,   0,   0,   6,   0,   0,
         37,   1, 127,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.25560 | Validation loss: 0.20357 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.51it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.44it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.08it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.01 seconds
tensor([  1,   0,   0,   0,   1,  21,   0, 166,   0,   0,   1,  10,   0,   0,
         30,   0, 129,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.05it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.24198 | Validation loss: 0.20321 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.78it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.16it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.01 seconds
tensor([  1,   0,   0,   0,   2,  15,   0, 164,   0,   0,   0,   8,   0,   0,
         33,   0, 136,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.93it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 80,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,
         0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.25118 | Validation loss: 0.19791 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.68it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.79it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0, 186,   0,   0,   0,   0,   0,   0,
          0,   0,  14,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.07it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.51it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.71it/s]                                                                                                    1.01 seconds
tensor([  3,   0,   0,   0,   0,  20,   0, 193,   0,   0,   1,  10,   0,   0,
         27,   0, 105,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.93it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.24699 | Validation loss: 0.20405 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.38it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.44it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.59it/s]                                                                                                    1.02 seconds
tensor([  2,   0,   0,   0,   1,  26,   1, 243,   0,   0,   1,   6,   0,   0,
         28,   1,  50,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.26078 | Validation loss: 0.20080 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.83it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.62it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.88it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.51it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.94it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.10it/s]                                                                                                    0.98 seconds
tensor([  4,   0,   0,   0,   4,  51,   1, 248,   1,   0,   0,  13,   0,   0,
          1,   1,  35,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.95it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.25021 | Validation loss: 0.20181 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.73it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.60it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.76it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.69it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.86it/s]                                                                                                    1.00 seconds
tensor([  2,   0,   0,   0,   2,  92,   3, 219,   1,   0,   2,   9,   0,   0,
          0,   0,  29,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.83it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.26469 | Validation loss: 0.19972 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.70it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.68it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.97it/s]                                                                                                    1.00 seconds
tensor([  2,   0,   0,   0,   0, 105,   1, 209,   1,   0,   0,   6,   0,   0,
          0,   4,  31,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.73it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.27762 | Validation loss: 0.20288 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.43it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.70it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.87it/s]                                                                                                    0.99 seconds
tensor([  2,   0,   0,   0,   4,  82,   1, 234,   0,   0,   0,   5,   0,   0,
          1,   0,  30,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.63it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.24465 | Validation loss: 0.20589 | Validation acc: 63.4
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.17it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.40it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.78it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.85it/s]                                                                                                    1.00 seconds
tensor([  2,   0,   0,   0,   1,  99,   0, 235,   1,   0,   1,   7,   0,   0,
          0,   0,  13,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.85it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 22 | Train loss: 0.24575 | Validation loss: 0.20467 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.61it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.71it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.66it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 13.00it/s]                                                                                                    0.99 seconds
tensor([  3,   0,   0,   0,   0, 101,   0, 225,   0,   0,   1,  10,   0,   0,
          1,   0,  17,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.72it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 23 | Train loss: 0.25285 | Validation loss: 0.20269 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.91it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.66it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.92it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.52it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.64it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.88it/s]                                                                                                    0.99 seconds
tensor([  4,   0,   0,   0,   2, 109,   0, 223,   0,   0,   2,   5,   0,   0,
          1,   1,  12,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 24 | Train loss: 0.24737 | Validation loss: 0.20248 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.43it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.63it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.33it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.77it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.97it/s]                                                                                                    1.00 seconds
tensor([  2,   0,   0,   0,   1, 111,   1, 210,   0,   0,   2,   9,   0,   0,
          0,   1,  22,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 25 | Train loss: 0.24501 | Validation loss: 0.20570 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=3 num_virtual_tokens_full=60 perturb_router=True topk=1 random_seed=42
Test result | Loss : 55.0 | Score : 55.0
Took 0.59 minutes for training
Took 1.04 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5806.55it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6025.67it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6030.11it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 7680
prompt_encoder.router.0.weight 1536
trainable params: 9216 || all params: 222891264 || trainable%: 0.004134751553116052
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:11,  1.01s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.10it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.09it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.81it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.52it/s]                                                                                                    1.88 seconds
tensor([294,  65], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.14it/s]                                                                                                    tensor([78,  4], device='cuda:0')
Epoch 1 | Train loss: 0.25998 | Validation loss: 0.21127 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.79it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.78it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 55.0
tensor([184,  16], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.94it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.30it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.96it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.18it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.42it/s]                                                                                                    1.03 seconds
tensor([ 48, 311], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 2 | Train loss: 1.57901 | Validation loss: 0.24654 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.08it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.16it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.70it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.15it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.32it/s]                                                                                                    1.04 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.63it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.48209 | Validation loss: 2.03757 | Validation acc: 34.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.18it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.91it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.20it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.37it/s]                                                                                                    1.03 seconds
tensor([ 35, 324], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.47801 | Validation loss: 0.23767 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.68it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.16it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.89it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.52it/s]                                                                                                    1.02 seconds
tensor([ 31, 328], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 5 | Train loss: 0.28241 | Validation loss: 0.32107 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.12it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.77it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.11it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.36it/s]                                                                                                    1.05 seconds
tensor([ 25, 334], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 6 | Train loss: 0.28376 | Validation loss: 0.23763 | Validation acc: 48.8
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.51it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.18it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.96it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.55it/s]                                                                                                    1.02 seconds
tensor([ 31, 328], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 7 | Train loss: 0.26960 | Validation loss: 0.32771 | Validation acc: 48.8
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.40it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.11it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.68it/s]                                                                                                    1.01 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 8 | Train loss: 0.27758 | Validation loss: 0.23356 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.78it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.28it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.21it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.39it/s]                                                                                                    1.03 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.54it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 9 | Train loss: 0.28964 | Validation loss: 0.30600 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.64it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.20it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.28it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.52it/s]                                                                                                    1.02 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 10 | Train loss: 0.25526 | Validation loss: 0.27501 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.27it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.34it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.92it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.18it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.31it/s]                                                                                                    1.03 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 11 | Train loss: 0.25606 | Validation loss: 0.26764 | Validation acc: 51.2
Patience of loss-based early stopping has reached 0. No more updates.
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=10 perturb_router=True topk=1 random_seed=42
Test result | Loss : 55.0 | Score : 55.0
Took 0.26 minutes for training
Took 1.11 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5713.88it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6027.99it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6033.23it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 3072
trainable params: 18432 || all params: 222900480 || trainable%: 0.008269161196961083
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.06it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  7.04it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.52it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.57it/s]                                                                                                    1.83 seconds
tensor([ 22,  34, 135, 168], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.97it/s]                                                                                                    tensor([ 0,  0, 82,  0], device='cuda:0')
Epoch 1 | Train loss: 0.27726 | Validation loss: 0.21831 | Validation acc: 53.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.52it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.66it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 54.0
tensor([  0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.62it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.28it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.40it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.92it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.17it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.34it/s]                                                                                                    1.03 seconds
tensor([ 12,  27, 307,  13], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0,  0, 82,  0], device='cuda:0')
Epoch 2 | Train loss: 0.25838 | Validation loss: 0.22210 | Validation acc: 61.0
Updating result due to higher validation score
Epoch 2 test result: 54.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.68it/s]                                                                                                    1.02 seconds
tensor([ 20,   7, 203, 129], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0, 78,  4], device='cuda:0')
Epoch 3 | Train loss: 0.27744 | Validation loss: 0.22600 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.42it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.60it/s]                                                                                                    1.01 seconds
tensor([ 29,   4, 194, 132], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.27040 | Validation loss: 0.22125 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.78it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.50it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.22it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.68it/s]                                                                                                    1.00 seconds
tensor([ 21,  35,  14, 289], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.89it/s]                                                                                                    tensor([ 8,  0,  0, 74], device='cuda:0')
Epoch 5 | Train loss: 0.34180 | Validation loss: 0.22415 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.64it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.11it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.01 seconds
tensor([ 19, 172,  12, 156], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.87it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25586 | Validation loss: 0.22013 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.50it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.13it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.51it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.14it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.64it/s]                                                                                                    1.02 seconds
tensor([ 16, 216,   3, 124], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 7 | Train loss: 0.24935 | Validation loss: 0.22454 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.89it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.21it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.56it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.85it/s]                                                                                                    0.99 seconds
tensor([  9,  51,   6, 293], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 8 | Train loss: 0.26436 | Validation loss: 0.22842 | Validation acc: 53.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.83it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.14it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.51it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([  7,  54,   7, 291], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 9 | Train loss: 0.25685 | Validation loss: 0.22288 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.72it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.75it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.71it/s]                                                                                                    1.00 seconds
tensor([ 12,  52,   6, 289], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 10 | Train loss: 0.26519 | Validation loss: 0.21857 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.91it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([ 16,  16,  14, 313], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 11 | Train loss: 0.25308 | Validation loss: 0.22433 | Validation acc: 63.4
Patience of loss-based early stopping has reached 0. No more updates.
Updating result due to higher validation score
Epoch 11 test result: 54.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.11it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.08it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.96it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.49it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.72it/s]                                                                                                    1.01 seconds
tensor([ 14,  21,  23, 301], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.82it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 12 | Train loss: 0.25697 | Validation loss: 0.22114 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 12 test result: 54.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.49it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.66it/s]                                                                                                    1.01 seconds
tensor([ 12,  21,  17, 309], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 13 | Train loss: 0.28735 | Validation loss: 0.22155 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.79it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.60it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.77it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.39it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.76it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.73it/s]                                                                                                    1.00 seconds
tensor([ 16,  30,  21, 292], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.88it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 14 | Train loss: 0.26740 | Validation loss: 0.24171 | Validation acc: 51.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.51it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.37it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.76it/s]                                                                                                    1.00 seconds
tensor([ 13,  21,  18, 307], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.78it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 15 | Train loss: 0.25402 | Validation loss: 0.21991 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.86it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.63it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.81it/s]                                                                                                    1.00 seconds
tensor([ 16,  22,  11, 310], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 16 | Train loss: 0.26259 | Validation loss: 0.22496 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.06it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.77it/s]                                                                                                    1.01 seconds
tensor([ 25,  26,  17, 291], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.75it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 17 | Train loss: 0.25710 | Validation loss: 0.21736 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.48it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.14it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.79it/s]                                                                                                    1.01 seconds
tensor([ 14,  23,   9, 313], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 18 | Train loss: 0.26172 | Validation loss: 0.21958 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.41it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.01 seconds
tensor([ 12,  61,   7, 279], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.89it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 19 | Train loss: 0.24414 | Validation loss: 0.22794 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.85it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.39it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.72it/s]                                                                                                    1.00 seconds
tensor([ 13,  82,   9, 255], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.55it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 20 | Train loss: 0.24244 | Validation loss: 0.22692 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.86it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.79it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.24it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.74it/s]                                                                                                    1.00 seconds
tensor([ 16,  37,  13, 293], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 21 | Train loss: 0.26672 | Validation loss: 0.21998 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.59it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.64it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.70it/s]                                                                                                    1.00 seconds
tensor([ 12,  25,  24, 298], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.43it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 22 | Train loss: 0.26233 | Validation loss: 0.22276 | Validation acc: 53.7
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 54.0 | Score : 54.0
Took 0.49 minutes for training
Took 1.04 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=50 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5589.89it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5905.04it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 5951.48it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 38400
prompt_encoder.router.0.weight 7680
trainable params: 46080 || all params: 222928128 || trainable%: 0.020670339096912883
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.03it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.23it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.99it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.51it/s]                                                                                                    1.84 seconds
tensor([ 10,  29,  14, 216,  47,   5,  11,   3,   7,  17], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.02it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.29316 | Validation loss: 0.22272 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.77it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.82it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 54.0
tensor([  0,   0,   0, 200,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.96it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.68it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.10it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.86it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.14it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.29it/s]                                                                                                    1.05 seconds
tensor([  1,  54,  11, 269,   4,   0,   1,  12,   1,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.26009 | Validation loss: 0.22070 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.40it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.57it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 55.0
tensor([  0,   0,   0, 200,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.76it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.44it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.43it/s]                                                                                                    1.03 seconds
tensor([  0,  16,   2, 282,   4,   1,   5,   5,  40,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.61it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.26565 | Validation loss: 0.21479 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.71it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.75it/s]                                                                                                    tensor([  0,   0,   0, 196,   0,   0,   0,   0,   4,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.68it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.20it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.81it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.40it/s]                                                                                                    1.04 seconds
tensor([  2,   3,   1, 208,   0,   1,   0,   0, 142,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.25244 | Validation loss: 0.22668 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.03it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.20it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.71it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.08it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.35it/s]                                                                                                    1.05 seconds
tensor([  0,  10,   2, 222,   0,   0,   0,   1, 121,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.47it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.26234 | Validation loss: 0.24523 | Validation acc: 48.8
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.94it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.13it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.78it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.10it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.22it/s]                                                                                                    1.04 seconds
tensor([  1,   8,   3, 291,   3,   6,  26,   2,  17,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.56it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25482 | Validation loss: 0.21508 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.95it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.84it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.13it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.03 seconds
tensor([  0,   4,   0, 232,   1,   1, 115,   0,   4,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.34it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.26982 | Validation loss: 0.22204 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 7 test result: 56.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.51it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.61it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.76it/s]                                                                                                    1.01 seconds
tensor([  0,   2,   1, 218,   1,   3, 130,   1,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.26339 | Validation loss: 0.22221 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.09it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.60it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.00 seconds
tensor([  0,  11,   1, 223,   0,   5, 110,   0,   9,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25352 | Validation loss: 0.22536 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.40it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.42it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.92it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.75it/s]                                                                                                    1.02 seconds
tensor([  0,  11,   1, 278,   3,   9,  35,   3,  14,   5], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.26896 | Validation loss: 0.22103 | Validation acc: 68.3
Updating result due to higher validation score
Epoch 10 test result: 56.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.83it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.17it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.02it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.42it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.55it/s]                                                                                                    1.03 seconds
tensor([  0,   3,   1, 241,   1,   3, 103,   2,   3,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.26292 | Validation loss: 0.22013 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.67it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.38it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.17it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.59it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.01 seconds
tensor([  2,   2,   0, 242,   1,   2,  98,   1,  10,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.52it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.25656 | Validation loss: 0.21722 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.70it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.53it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.22it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.73it/s]                                                                                                    1.00 seconds
tensor([  0,   1,   0, 248,   0,   1, 101,   2,   5,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.44it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.26390 | Validation loss: 0.21937 | Validation acc: 65.9
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.40it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.14it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.14it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.73it/s]                                                                                                    1.01 seconds
tensor([  1,   9,   0, 262,   1,   2,  77,   0,   6,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.44it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.26189 | Validation loss: 0.21580 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.63it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.14it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.56it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.89it/s]                                                                                                    1.00 seconds
tensor([  0,   3,   0, 264,   0,   3,  79,   1,   8,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.65it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.25184 | Validation loss: 0.21925 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.41it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.14it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.52it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.01 seconds
tensor([  1,   3,   2, 296,   4,   2,  14,   2,  35,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.24897 | Validation loss: 0.22293 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.01 seconds
tensor([  0,   6,  13, 279,   1,  11,  31,   2,  14,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.40it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.25803 | Validation loss: 0.21852 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.34it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.48it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.01 seconds
tensor([  0,   9,   2, 295,   3,   3,  22,   1,  24,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.24621 | Validation loss: 0.22269 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.61it/s]                                                                                                    1.02 seconds
tensor([  1,   7,   4, 267,   4,   3,  31,   1,  40,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.38it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.25210 | Validation loss: 0.21740 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.64it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.65it/s]                                                                                                    1.01 seconds
tensor([  1,   5,   5, 287,   3,   4,  28,   0,  25,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0, 82,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.24509 | Validation loss: 0.21855 | Validation acc: 61.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=50 perturb_router=True topk=1 random_seed=42
Test result | Loss : 56.0 | Score : 56.0
Took 0.46 minutes for training
Took 1.06 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5831.08it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6074.19it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6085.67it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 76800
prompt_encoder.router.0.weight 15360
trainable params: 92160 || all params: 222974208 || trainable%: 0.04133213470142699
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:11,  1.01s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.11it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.12it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  8.24it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  9.42it/s]                                                                                                    1.88 seconds
tensor([ 13,   0,  45,  11,  23,  20,   0,   1,   1,  12, 103,   3,   1,   2,
         13,   2,  10,  71,  11,  17], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.11it/s]                                                                                                    tensor([ 0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.26045 | Validation loss: 0.22044 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.95it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.89it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 47.0
tensor([  0,   0, 196,   0,   0,   4,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.77it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.22it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.28it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.94it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.71it/s]                                                                                                    1.02 seconds
tensor([  0,   0, 101,   0,   0,  23,   0,   1,   1,   0,   0,   0,   0,   0,
        207,   0,   0,  21,   5,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.29992 | Validation loss: 0.22044 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.27it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.43it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.91it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.31it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.49it/s]                                                                                                    1.02 seconds
tensor([  0,   0,   5,   0,   1,   2,   0,   0,   1,   0,   0,   0,   1,   0,
        192,  13,   2,   1, 141,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.66it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        82,  0], device='cuda:0')
Epoch 3 | Train loss: 0.26153 | Validation loss: 0.23099 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.14it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.95it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.14it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.08it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.30it/s]                                                                                                    1.04 seconds
tensor([  0,   0,  57,   0,   4,   0,  23,   1,   0,   0,   0,   0,   0,   0,
         76,   0,   1,   3, 194,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.30148 | Validation loss: 0.29591 | Validation acc: 51.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.91it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.45it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.04it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.31it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.52it/s]                                                                                                    1.02 seconds
tensor([  0,   0,  37,   0,   2,   0, 194,   0,   0,   0,   0,   0,   0,   0,
          1,   0,   1,   0, 124,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.27234 | Validation loss: 0.49560 | Validation acc: 48.8
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.37it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.99it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.17it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.14it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.23it/s]                                                                                                    1.04 seconds
tensor([  0,   0,  36,   0,   3,   0, 195,   0,   3,   0,   0,   0,   0,   0,
          2,   0,   0,   0, 120,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.92it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.27411 | Validation loss: 0.22362 | Validation acc: 51.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.78it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.47it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.40it/s]                                                                                                    1.03 seconds
tensor([  0,   0,  34,   0,   3,   0, 138,   0,   4,   0,   0,   0,   0,   0,
          0,   0, 157,   0,  23,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.94475 | Validation loss: 0.25501 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.75it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.30it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.45it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.50it/s]                                                                                                    1.01 seconds
tensor([  0,   0,  29,   0,   2,   0, 124,   0,   2,   0,   0,   0,   0,   0,
          2,   0, 200,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.27845 | Validation loss: 0.24899 | Validation acc: 48.8
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.19it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.31it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.95it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.57it/s]                                                                                                    1.01 seconds
tensor([  0,   1,  22,   0,   4,   0, 200,   0,   4,   0,   0,   0,   1,   1,
          0,   0, 126,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.82it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25981 | Validation loss: 0.21700 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.66it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.69it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.71it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.17it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.39it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.92it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.33it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.33it/s]                                                                                                    1.02 seconds
tensor([  0,   9,  21,   0,   3,   0, 230,   0,   1,   0,   0,   0,   0,   0,
          0,   0,  95,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.94it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.26039 | Validation loss: 0.23464 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.99it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.42it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.41it/s]                                                                                                    1.02 seconds
tensor([  1,   3,  16,   0,   5,   0, 248,   0,   1,   0,   0,   0,   0,   2,
          0,   0,  83,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.95it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.25364 | Validation loss: 0.22824 | Validation acc: 61.0
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.05it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.07it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.08it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.44it/s]                                                                                                    1.03 seconds
tensor([  0,   5,   1,   0,   2,   0, 268,   0,   1,   0,   0,   0,   0,   7,
          1,   0,  74,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  7.04it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.26383 | Validation loss: 0.22136 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.89it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.26it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.39it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.89it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.54it/s]                                                                                                    1.02 seconds
tensor([  1,   5,   3,   0,   3,   0, 269,   0,   3,   0,   0,   0,   0,   6,
          1,   0,  68,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.99it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.25660 | Validation loss: 0.21903 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.27it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.73it/s]                                                                                                    1.01 seconds
tensor([  0,   6,   2,   0,   1,   0, 248,   0,   5,   0,   0,   0,   0,   8,
          1,   0,  87,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.81it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.25480 | Validation loss: 0.22039 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.79it/s]                                                                                                    1.00 seconds
tensor([  3,   9,   0,   0,   0,   0, 254,   0,   2,   0,   0,   0,   0,  12,
          0,   0,  79,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.73it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.26090 | Validation loss: 0.22383 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.88it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.26it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([  1,   7,   1,   0,   2,   0, 253,   0,   3,   1,   0,   0,   0,   7,
          0,   0,  84,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.25360 | Validation loss: 0.21675 | Validation acc: 51.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.87it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.79it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.96it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.00 seconds
tensor([  2,   7,   2,   0,   0,   0, 254,   0,   0,   0,   0,   0,   0,  15,
          0,   0,  79,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.85it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.25571 | Validation loss: 0.21744 | Validation acc: 51.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([  1,   5,   3,   0,   1,   0, 248,   0,   3,   0,   0,   0,   0,  14,
          0,   0,  84,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.90it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.24637 | Validation loss: 0.21481 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.84it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.76it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.11it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.05it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.27it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.09it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.50it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.57it/s]                                                                                                    1.01 seconds
tensor([  1,   6,   3,   0,   3,   0, 253,   0,   2,   0,   0,   0,   0,   6,
          2,   0,  83,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.81it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.25310 | Validation loss: 0.21286 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.87it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.80it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.72it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.48it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.61it/s]                                                                                                    1.00 seconds
tensor([  4,   6,   1,   0,   1,   0, 247,   0,   7,   0,   0,   0,   0,  12,
          2,   0,  77,   1,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.79it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.25772 | Validation loss: 0.21745 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.89it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.61it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.90it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.47it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.58it/s]                                                                                                    1.00 seconds
tensor([  3,   3,   3,   0,   4,   0, 273,   0,   1,   0,   0,   0,   0,   7,
          0,   0,  65,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.78it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.24715 | Validation loss: 0.21585 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.91it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.68it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.30it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.51it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.58it/s]                                                                                                    1.00 seconds
tensor([  0,   2,   0,   0,   3,   0, 238,   0,   3,   0,   0,   0,   0,  10,
          0,   0, 101,   1,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.96it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 22 | Train loss: 0.24560 | Validation loss: 0.22224 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.06it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.78it/s]                                                                                                    1.00 seconds
tensor([  2,   5,   0,   0,   0,   0, 230,   0,   9,   0,   0,   0,   0,   9,
          0,   0, 103,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 23 | Train loss: 0.24339 | Validation loss: 0.21203 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.83it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.81it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.21it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.63it/s]                                                                                                    1.01 seconds
tensor([  0,   9,   0,   0,   6,   0, 221,   0,   3,   0,   0,   0,   0,   6,
          1,   0, 113,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.91it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 24 | Train loss: 0.25060 | Validation loss: 0.21656 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.92it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.67it/s]                                                                                                    1.01 seconds
tensor([  2,   3,   0,   0,   0,   0, 262,   0,   6,   0,   0,   0,   0,   5,
          1,   0,  80,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 25 | Train loss: 0.24392 | Validation loss: 0.21463 | Validation acc: 51.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.03it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.93it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.29it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.44it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.79it/s]                                                                                                    1.01 seconds
tensor([  2,   4,   1,   0,   1,   0, 249,   0,  12,   0,   0,   0,   0,  10,
          1,   0,  79,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 26 | Train loss: 0.25377 | Validation loss: 0.21584 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.38it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.53it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.61it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.69it/s]                                                                                                    1.00 seconds
tensor([  1,   1,   0,   0,   5,   0, 242,   0,   3,   0,   0,   0,   0,   6,
          0,   0, 101,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 27 | Train loss: 0.25452 | Validation loss: 0.21484 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.40it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.51it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.52it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.57it/s]                                                                                                    1.01 seconds
tensor([  3,   2,   1,   0,   1,   0, 257,   0,   4,   0,   0,   0,   0,  12,
          0,   0,  79,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 28 | Train loss: 0.25177 | Validation loss: 0.21076 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.57it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.63it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.91it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.68it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.01it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.75it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.99it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.25it/s]                                                                                                    1.05 seconds
tensor([  1,   3,   1,   0,   1,   0, 256,   0,  11,   0,   0,   0,   0,   6,
          0,   0,  79,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 29 | Train loss: 0.25649 | Validation loss: 0.21115 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.90it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.75it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.12it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.31it/s]                                                                                                    1.02 seconds
tensor([  1,   4,   0,   0,   1,   0, 243,   0,   5,   0,   0,   0,   0,  14,
          1,   0,  90,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.94it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 30 | Train loss: 0.23473 | Validation loss: 0.21047 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.73it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.69it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.95it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.15it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.49it/s]                                                                                                    1.02 seconds
tensor([  4,   2,   0,   0,   0,   0, 240,   0,   7,   0,   0,   0,   0,   9,
          0,   0,  97,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.93it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 31 | Train loss: 0.23442 | Validation loss: 0.20970 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.81it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.76it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.52it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.99it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.77it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.13it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.42it/s]                                                                                                    1.03 seconds
tensor([  1,   3,   0,   0,   1,   0, 259,   0,   5,   0,   0,   0,   0,   6,
          0,   0,  84,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.70it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 32 | Train loss: 0.25536 | Validation loss: 0.21080 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.13it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.23it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.71it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.09it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.42it/s]                                                                                                    1.03 seconds
tensor([  3,   2,   1,   0,   2,   0, 222,   0,   8,   0,   0,   0,   0,   6,
          0,  10, 105,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 33 | Train loss: 0.24419 | Validation loss: 0.20863 | Validation acc: 61.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.57it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.65it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  7.00it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.40it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.30it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.43it/s]                                                                                                    1.03 seconds
tensor([  0,   1,   2,   0,   0,   0, 275,   0,  12,   0,   0,   0,   0,   2,
          0,  10,  57,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.74it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 34 | Train loss: 0.24746 | Validation loss: 0.20855 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.61it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.65it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.74it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.21it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.39it/s]                                                                                                    1.02 seconds
tensor([  0,   8,   1,   0,   0,   0, 258,   0,   7,   0,   0,   0,   0,   4,
          0,  11,  70,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.84it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 35 | Train loss: 0.23581 | Validation loss: 0.20879 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.01it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.70it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.10it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.61it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.08it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.26it/s]                                                                                                    1.05 seconds
tensor([  1,   3,   0,   0,   3,   0, 275,   0,   5,   0,   0,   0,   0,   8,
          1,   4,  59,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.83it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 36 | Train loss: 0.24171 | Validation loss: 0.20676 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.72it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.70it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.81it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.99it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.29it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.41it/s]                                                                                                    1.02 seconds
tensor([  1,   2,   0,   0,   3,   0, 286,   0,   5,   1,   0,   0,   0,   7,
          0,   0,  54,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 37 | Train loss: 0.24966 | Validation loss: 0.20170 | Validation acc: 68.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.52it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.58it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.06it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.04it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.23it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.11it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.25it/s]                                                                                                    1.04 seconds
tensor([  1,   2,   0,   0,   1,   0, 270,   0,   8,   0,   0,   0,   0,   4,
          0,   1,  72,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 38 | Train loss: 0.24832 | Validation loss: 0.20071 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.80it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.76it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.83it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.43it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.41it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.06it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.38it/s]                                                                                                    1.02 seconds
tensor([  1,   2,   1,   0,   0,   0, 266,   0,   4,   1,   0,   0,   0,   6,
          0,   2,  75,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 39 | Train loss: 0.24408 | Validation loss: 0.20091 | Validation acc: 68.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.30it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.48it/s]                                                                                                    1.02 seconds
tensor([  0,   2,   2,   0,   0,   0, 276,   0,   6,   0,   0,   0,   0,   2,
          2,   3,  66,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.86it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 40 | Train loss: 0.24918 | Validation loss: 0.20181 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.73it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.31it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.37it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.16it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.35it/s]                                                                                                    1.03 seconds
tensor([  2,   6,   0,   0,   0,   0, 253,   0,   7,   0,   0,   0,   0,   8,
          1,   0,  82,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.62it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 41 | Train loss: 0.24337 | Validation loss: 0.20089 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.65it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.29it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.42it/s]                                                                                                    1.02 seconds
tensor([  1,   2,   0,   0,   1,   0, 252,   0,   7,   0,   0,   0,   0,   4,
          2,   1,  88,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.90it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 42 | Train loss: 0.24674 | Validation loss: 0.20200 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.21it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.03it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.40it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.81it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.38it/s]                                                                                                    1.03 seconds
tensor([  0,   2,   0,   0,   2,   0, 249,   0,   9,   0,   0,   0,   0,   3,
          0,   1,  93,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 43 | Train loss: 0.24144 | Validation loss: 0.20274 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.51it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.12it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.57it/s]                                                                                                    1.00 seconds
tensor([  2,   2,   1,   0,   3,   0, 257,   0,   8,   0,   0,   0,   0,   6,
          0,   2,  77,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.79it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 44 | Train loss: 0.23364 | Validation loss: 0.20220 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.84it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.13it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.79it/s]                                                                                                    1.00 seconds
tensor([  3,   5,   0,   0,   1,   0, 253,   0,   6,   0,   0,   0,   0,   2,
          0,   1,  88,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.80it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 45 | Train loss: 0.23114 | Validation loss: 0.20254 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.87it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.72it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.69it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.57it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.00 seconds
tensor([  0,   3,   1,   0,   2,   0, 255,   0,   9,   0,   0,   0,   0,   5,
          1,   2,  80,   1,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.97it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 46 | Train loss: 0.24214 | Validation loss: 0.20182 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.86it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.62it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.36it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.53it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.68it/s]                                                                                                    0.99 seconds
tensor([  1,   5,   0,   0,   2,   0, 265,   0,   6,   0,   0,   0,   0,   5,
          1,   1,  73,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.76it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 47 | Train loss: 0.24377 | Validation loss: 0.20197 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.61it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 12.09it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 12.48it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.62it/s]                                                                                                    1.01 seconds
tensor([  3,   1,   0,   0,   3,   0, 253,   0,   4,   1,   0,   0,   0,   2,
          0,   1,  90,   0,   1,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 48 | Train loss: 0.23442 | Validation loss: 0.20226 | Validation acc: 56.1
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=5 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Test result | Loss : 55.0 | Score : 47.0
Took 1.13 minutes for training
Took 1.04 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5904.30it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6118.06it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6116.11it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 15360
prompt_encoder.router.0.weight 1536
trainable params: 16896 || all params: 222898944 || trainable%: 0.0075801166648864875
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.02it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.14it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.10it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.68it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  7.88it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  8.88it/s]                                                                                                    1.93 seconds
tensor([147, 212], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.88it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 1 | Train loss: 0.27160 | Validation loss: 0.21509 | Validation acc: 68.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.19it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  8.95it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 53.0
tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.96it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.39it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.19it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.47it/s]                                                                                                    1.11 seconds
tensor([ 79, 280], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.50it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 2 | Train loss: 0.26961 | Validation loss: 0.29857 | Validation acc: 48.8
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.16it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.30it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.68it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.02it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.55it/s]                                                                                                    1.11 seconds
tensor([ 31, 328], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.28it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.30845 | Validation loss: 0.22466 | Validation acc: 65.9
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.48it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.88it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.18it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.39it/s]                                                                                                    1.11 seconds
tensor([ 31, 328], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.32it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.25502 | Validation loss: 0.23056 | Validation acc: 51.2
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.66it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.87it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.52it/s]                                                                                                    1.11 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.39it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 5 | Train loss: 0.26333 | Validation loss: 0.21430 | Validation acc: 58.5
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.44it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.08it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.34it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.91it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.22it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.18it/s]                                                                                                    1.12 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.35it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 6 | Train loss: 0.25336 | Validation loss: 0.21191 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.13it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  8.91it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:01,  8.99it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.68it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.06it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.32it/s]                                                                                                    1.13 seconds
tensor([ 26, 333], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 7 | Train loss: 0.25393 | Validation loss: 0.21155 | Validation acc: 53.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.36it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.04it/s]                                                                                                    tensor([  0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.27it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.22it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.57it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.38it/s]                                                                                                    1.11 seconds
tensor([ 25, 334], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 8 | Train loss: 0.25861 | Validation loss: 0.21700 | Validation acc: 58.5
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.55it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.68it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.59it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.08it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.58it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.67it/s]                                                                                                    1.09 seconds
tensor([ 34, 325], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.30it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 9 | Train loss: 0.25486 | Validation loss: 0.22639 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.39it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.86it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.02it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.44it/s]                                                                                                    1.12 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 10 | Train loss: 0.26485 | Validation loss: 0.22393 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.40it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.56it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.17it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.21it/s]                                                                                                    1.12 seconds
tensor([ 36, 323], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 11 | Train loss: 0.24621 | Validation loss: 0.21747 | Validation acc: 65.9
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.30it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.30it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.01it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.45it/s]                                                                                                    1.11 seconds
tensor([ 28, 331], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.25it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 12 | Train loss: 0.26513 | Validation loss: 0.21553 | Validation acc: 65.9
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.75it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.90it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.48it/s]                                                                                                    1.10 seconds
tensor([ 35, 324], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.22it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 13 | Train loss: 0.23817 | Validation loss: 0.21635 | Validation acc: 56.1
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.06it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.02it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.25it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.86it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.45it/s]                                                                                                    1.12 seconds
tensor([ 21, 338], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 14 | Train loss: 0.25697 | Validation loss: 0.22127 | Validation acc: 63.4
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:01,  8.83it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.16it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.77it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.33it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.49it/s]                                                                                                    1.12 seconds
tensor([ 33, 326], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.45it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 15 | Train loss: 0.25832 | Validation loss: 0.22038 | Validation acc: 63.4
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.57it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.60it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.68it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.28it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.78it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.58it/s]                                                                                                    1.09 seconds
tensor([ 24, 335], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.40it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 16 | Train loss: 0.24189 | Validation loss: 0.21983 | Validation acc: 61.0
tensor([0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.19it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.87it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.81it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.20it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.52it/s]                                                                                                    1.09 seconds
tensor([ 23, 336], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0, 82], device='cuda:0')
Epoch 17 | Train loss: 0.25361 | Validation loss: 0.22031 | Validation acc: 61.0
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=20 perturb_router=True topk=1 random_seed=42
Test result | Loss : 58.0 | Score : 53.0
Took 0.43 minutes for training
Took 1.16 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=40 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5927.94it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5133.02it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6110.94it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 30720
prompt_encoder.router.0.weight 3072
trainable params: 33792 || all params: 222915840 || trainable%: 0.015159084253501232
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:11,  1.01s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.10it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.06it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.67it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  7.98it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  8.84it/s]                                                                                                    1.93 seconds
tensor([ 54,  98,  43, 164], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.91it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 1 | Train loss: 0.25949 | Validation loss: 0.20144 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.64it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.21it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 49.0
tensor([  0,   0,   0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.56it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.65it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.60it/s]                                                                                                    1.10 seconds
tensor([ 33,  38,  12, 276], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.31it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 2 | Train loss: 0.27363 | Validation loss: 0.21959 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.35it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.00it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.34it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.50it/s]                                                                                                    1.10 seconds
tensor([  3, 118,  22, 216], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.46it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.26115 | Validation loss: 0.20815 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.66it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.92it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.59it/s]                                                                                                    1.09 seconds
tensor([  2, 181,  23, 153], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.35it/s]                                                                                                    tensor([ 0,  0,  0, 82], device='cuda:0')
Epoch 4 | Train loss: 0.26672 | Validation loss: 0.20898 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.26it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.10it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.43it/s]                                                                                                    1.11 seconds
tensor([ 27, 248,  21,  63], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.61it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.27231 | Validation loss: 0.22474 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.64it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.37it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.96it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.30it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.53it/s]                                                                                                    1.10 seconds
tensor([ 45, 275,  18,  21], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.58it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.25974 | Validation loss: 0.21529 | Validation acc: 51.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.35it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.57it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.17it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.15it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.38it/s]                                                                                                    1.11 seconds
tensor([127, 212,  13,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([ 0, 82,  0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.27033 | Validation loss: 0.23093 | Validation acc: 61.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.60it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.60it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.60it/s]                                                                                                    1.10 seconds
tensor([135, 201,  13,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.39it/s]                                                                                                    tensor([24, 58,  0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.26239 | Validation loss: 0.22556 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.38it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.38it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.19it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.34it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.77it/s]                                                                                                    1.10 seconds
tensor([183, 164,   5,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([24, 58,  0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.25107 | Validation loss: 0.22006 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.39it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.18it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.10it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.36it/s]                                                                                                    1.11 seconds
tensor([174, 167,  14,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([24, 58,  0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.25490 | Validation loss: 0.21881 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 10 test result: 49.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.26it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.61it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.10it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.50it/s]                                                                                                    1.10 seconds
tensor([152, 188,  15,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([24, 58,  0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.26886 | Validation loss: 0.22200 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.65it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.54it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.87it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.29it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.45it/s]                                                                                                    1.09 seconds
tensor([263,  71,  17,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.40it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 12 | Train loss: 0.23796 | Validation loss: 0.21497 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.44it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.67it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.39it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.96it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.53it/s]                                                                                                    1.10 seconds
tensor([258,  80,  12,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.37it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 13 | Train loss: 0.24856 | Validation loss: 0.22074 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.22it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.91it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.82it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.18it/s]                                                                                                    1.11 seconds
tensor([272,  61,  14,  12], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 14 | Train loss: 0.24729 | Validation loss: 0.21727 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.75it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.73it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.20it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.25it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.41it/s]                                                                                                    1.10 seconds
tensor([252,  86,  10,  11], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.09it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 15 | Train loss: 0.24299 | Validation loss: 0.21204 | Validation acc: 58.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.11it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.19it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.33it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.98it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.16it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.32it/s]                                                                                                    1.12 seconds
tensor([274,  69,  15,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.30it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 16 | Train loss: 0.25046 | Validation loss: 0.21839 | Validation acc: 56.1
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.53it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:01,  8.76it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00,  9.92it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.17it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.43it/s]                                                                                                    1.13 seconds
tensor([255,  82,  13,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 17 | Train loss: 0.24170 | Validation loss: 0.20471 | Validation acc: 63.4
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.50it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.64it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.47it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.29it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.22it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.25it/s]                                                                                                    1.11 seconds
tensor([258,  75,  17,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.40it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 18 | Train loss: 0.24412 | Validation loss: 0.20416 | Validation acc: 68.3
Updating result due to higher validation score
Epoch 18 test result: 49.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.23it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.84it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.74it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.04it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.51it/s]                                                                                                    1.10 seconds
tensor([261,  79,  11,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.45it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 19 | Train loss: 0.24193 | Validation loss: 0.19619 | Validation acc: 68.3
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.36it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.86it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.02it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.51it/s]                                                                                                    1.10 seconds
tensor([283,  53,  11,  12], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.58it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 20 | Train loss: 0.24838 | Validation loss: 0.19676 | Validation acc: 73.2
Updating result due to higher validation score
Epoch 20 test result: 49.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.66it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.26it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.85it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.22it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.40it/s]                                                                                                    1.10 seconds
tensor([286,  47,  13,  13], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.35it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 21 | Train loss: 0.23453 | Validation loss: 0.19874 | Validation acc: 65.9
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.11it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.46it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.33it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.22it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.44it/s]                                                                                                    1.11 seconds
tensor([299,  35,   9,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.32it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 22 | Train loss: 0.23619 | Validation loss: 0.18949 | Validation acc: 80.5
Updating result due to higher validation score
Epoch 22 test result: 49.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.45it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.37it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.05it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.31it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.23it/s]                                                                                                    1.11 seconds
tensor([291,  34,  21,  13], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.49it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 23 | Train loss: 0.21862 | Validation loss: 0.17974 | Validation acc: 75.6
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.68it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.57it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.04it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.52it/s]                                                                                                    1.09 seconds
tensor([292,  41,  16,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 24 | Train loss: 0.22366 | Validation loss: 0.18704 | Validation acc: 65.9
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.16it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.75it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.47it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.16it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.39it/s]                                                                                                    1.11 seconds
tensor([278,  51,  21,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.25it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 25 | Train loss: 0.21628 | Validation loss: 0.19889 | Validation acc: 63.4
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.18it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.53it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.58it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.12it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.24it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.24it/s]                                                                                                    1.11 seconds
tensor([304,  28,  13,  14], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 26 | Train loss: 0.20705 | Validation loss: 0.18513 | Validation acc: 80.5
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.19it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.53it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.00it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.27it/s]                                                                                                    1.12 seconds
tensor([293,  20,  14,  32], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 27 | Train loss: 0.21965 | Validation loss: 0.18022 | Validation acc: 73.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.73it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.00it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.37it/s]                                                                                                    1.11 seconds
tensor([307,  25,  14,  13], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 28 | Train loss: 0.20554 | Validation loss: 0.18388 | Validation acc: 73.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.38it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.00it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.85it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.23it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.21it/s]                                                                                                    1.11 seconds
tensor([321,  21,   7,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.30it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 29 | Train loss: 0.20827 | Validation loss: 0.18652 | Validation acc: 78.0
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.21it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.51it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.77it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.69it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.52it/s]                                                                                                    1.09 seconds
tensor([310,  22,  12,  15], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.52it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 30 | Train loss: 0.20552 | Validation loss: 0.18254 | Validation acc: 73.2
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.31it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.31it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.36it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.74it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.52it/s]                                                                                                    1.11 seconds
tensor([299,  37,  13,  10], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.43it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 31 | Train loss: 0.21493 | Validation loss: 0.18253 | Validation acc: 70.7
tensor([0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.16it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.47it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.80it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.02it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.32it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.71it/s]                                                                                                    1.09 seconds
tensor([308,  30,  10,  11], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.36it/s]                                                                                                    tensor([82,  0,  0,  0], device='cuda:0')
Epoch 32 | Train loss: 0.20002 | Validation loss: 0.19009 | Validation acc: 70.7
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=40 perturb_router=True topk=1 random_seed=42
Test result | Loss : 49.0 | Score : 49.0
Took 0.75 minutes for training
Took 1.13 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5544.02it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 5816.16it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 5860.09it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 76800
prompt_encoder.router.0.weight 7680
trainable params: 84480 || all params: 222966528 || trainable%: 0.03788909517396261
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:01<00:11,  1.00s/it]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.10it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  4.99it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.52it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  7.93it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  8.82it/s]                                                                                                    1.95 seconds
tensor([133,   2,   8,   3,  67,  50,  40,  47,   7,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.86it/s]                                                                                                    tensor([82,  0,  0,  0,  0,  0,  0,  0,  0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.28322 | Validation loss: 0.26110 | Validation acc: 53.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.46it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.35it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 53.0
tensor([200,   0,   0,   0,   0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.23it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.88it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.42it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.57it/s]                                                                                                    1.10 seconds
tensor([227,   0,   0,   0,  65,   6,  59,   1,   0,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.31261 | Validation loss: 0.23245 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.15it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.15it/s]                                                                                                    Updating result due to higher validation score
Epoch 2 test result: 55.0
tensor([  0,   0,   0,   0,   0,   0, 200,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.37it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.44it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.32it/s]                                                                                                    1.11 seconds
tensor([  2,   2,   0,   0,  13,   1,  73,   0,  43, 225], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82], device='cuda:0')
Epoch 3 | Train loss: 0.34648 | Validation loss: 0.21752 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.29it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.23it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0, 200], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.48it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.37it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.17it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.82it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.41it/s]                                                                                                    1.12 seconds
tensor([  1,   1,   1,   1,   9,   0,  31,   0, 163, 152], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  6, 76,  0], device='cuda:0')
Epoch 4 | Train loss: 0.26075 | Validation loss: 0.43267 | Validation acc: 31.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.16it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.43it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.26it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.36it/s]                                                                                                    1.11 seconds
tensor([  1,   0,   2,   0,   3,   0,  20, 128, 203,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 5 | Train loss: 0.27688 | Validation loss: 0.22887 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.33it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.61it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.54it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.87it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.17it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.38it/s]                                                                                                    1.11 seconds
tensor([  1,   1,   3,   0,   1,   0,  16,  75, 260,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.34it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 6 | Train loss: 0.24884 | Validation loss: 0.22344 | Validation acc: 63.4
Updating result due to higher validation score
Epoch 6 test result: 54.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.14it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.30it/s]                                                                                                    1.12 seconds
tensor([  2,  19,   3,   0,   3,   0,   7,  42, 267,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.50it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 7 | Train loss: 0.26103 | Validation loss: 0.21889 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.21it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.80it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.45it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.51it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.62it/s]                                                                                                    1.10 seconds
tensor([  1,  37,   2,   1,   3,   1,  11,   2, 287,  14], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.55it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 8 | Train loss: 0.25714 | Validation loss: 0.21678 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.34it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.26it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.00it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.50it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.23it/s]                                                                                                    1.12 seconds
tensor([  0,  33,   5,   0,   6,   2,  24,   2, 271,  16], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 9 | Train loss: 0.24897 | Validation loss: 0.22445 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.36it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.13it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.34it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.50it/s]                                                                                                    1.11 seconds
tensor([ 42,   9,   1,   1,   6,   2,  16,   2, 275,   5], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 10 | Train loss: 0.26509 | Validation loss: 0.21625 | Validation acc: 56.1
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  5.99it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.06it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.04it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.34it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.25it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.87it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.20it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.36it/s]                                                                                                    1.12 seconds
tensor([ 72,   8,   1,   0,   2,   3,   2,   1, 267,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.32it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 11 | Train loss: 0.25658 | Validation loss: 0.22224 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.37it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.27it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.72it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.16it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.59it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.64it/s]                                                                                                    1.09 seconds
tensor([ 69,  11,   0,   1,   4,   3,   0,   2, 261,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.55it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 12 | Train loss: 0.25826 | Validation loss: 0.22107 | Validation acc: 65.9
Updating result due to higher validation score
Epoch 12 test result: 53.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.46it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.70it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.78it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.89it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.17it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.38it/s]                                                                                                    1.11 seconds
tensor([ 73,  15,   0,   0,   1,   2,   0,   1, 259,   8], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 13 | Train loss: 0.27087 | Validation loss: 0.21941 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.36it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.24it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.38it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.76it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.37it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.48it/s]                                                                                                    1.11 seconds
tensor([ 70,  16,   1,   1,   4,   1,   1,   3, 258,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.50it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 14 | Train loss: 0.25123 | Validation loss: 0.21622 | Validation acc: 51.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.14it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.18it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.33it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.56it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.35it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.19it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.56it/s]                                                                                                    1.11 seconds
tensor([ 69,  12,   2,   0,   0,   3,   0,   0, 266,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.56it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 15 | Train loss: 0.25260 | Validation loss: 0.21912 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.13it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.17it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.10it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.67it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.10it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.56it/s]                                                                                                    1.12 seconds
tensor([  4,  36,   1,   3,   5,   9,   0,   3, 295,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.32it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 16 | Train loss: 0.24699 | Validation loss: 0.22093 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.33it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.26it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.84it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.16it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.37it/s]                                                                                                    1.12 seconds
tensor([  7,  47,   2,   1,   2,   6,   1,   3, 281,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.54it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 17 | Train loss: 0.25645 | Validation loss: 0.22712 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.37it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.56it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.58it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.07it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.39it/s]                                                                                                    1.10 seconds
tensor([  7,  53,   3,   3,   2,   5,   0,   1, 279,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.60it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 18 | Train loss: 0.25814 | Validation loss: 0.22092 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.40it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.29it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.15it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.34it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.46it/s]                                                                                                    1.11 seconds
tensor([  9,  35,   0,  23,   0,   5,   3,   0, 278,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 19 | Train loss: 0.26194 | Validation loss: 0.22337 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.41it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.41it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.19it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.41it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.37it/s]                                                                                                    1.11 seconds
tensor([  3,  42,   0,  22,   2,   6,   0,   0, 282,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.48it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 20 | Train loss: 0.24261 | Validation loss: 0.21353 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.28it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.26it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.64it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.07it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.09it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.33it/s]                                                                                                    1.11 seconds
tensor([  7,  38,   0,  21,   1,   7,   0,   1, 277,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 21 | Train loss: 0.24406 | Validation loss: 0.21329 | Validation acc: 63.4
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.07it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.13it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.46it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.67it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.88it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.51it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.35it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.30it/s]                                                                                                    1.10 seconds
tensor([  5,  43,   1,  16,   0,   5,   0,   2, 276,  11], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.27it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 22 | Train loss: 0.23898 | Validation loss: 0.21354 | Validation acc: 65.9
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.69it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.50it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.01it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.29it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.47it/s]                                                                                                    1.10 seconds
tensor([  7,  34,   0,  24,   2,   2,   1,   1, 279,   9], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 23 | Train loss: 0.23269 | Validation loss: 0.20413 | Validation acc: 68.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.28it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.23it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.30it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.62it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.37it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.95it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.24it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.60it/s]                                                                                                    1.10 seconds
tensor([  8,  46,   0,  29,   1,  14,   0,   0, 259,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.50it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 24 | Train loss: 0.24085 | Validation loss: 0.20830 | Validation acc: 61.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.34it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.56it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.34it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.91it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 10.99it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.22it/s]                                                                                                    1.12 seconds
tensor([  4,  43,   0,  21,   3,   5,   1,   3, 279,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.23it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 25 | Train loss: 0.22884 | Validation loss: 0.20476 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.32it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.55it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.08it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.26it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.51it/s]                                                                                                    1.10 seconds
tensor([  4,  47,   0,  16,   8,  11,   2,   2, 268,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.48it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 26 | Train loss: 0.23600 | Validation loss: 0.19782 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.07it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.09it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.35it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.36it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.20it/s]                                                                                                    1.12 seconds
tensor([  6,  43,   0,  20,   7,   9,   1,   2, 269,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.26it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 27 | Train loss: 0.22494 | Validation loss: 0.19452 | Validation acc: 68.3
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.09it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.11it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.49it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.40it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.90it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.63it/s]                                                                                                    1.10 seconds
tensor([  4,  42,   0,  18,   8,   8,   0,   0, 276,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.31it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 28 | Train loss: 0.22912 | Validation loss: 0.19955 | Validation acc: 68.3
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.15it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.70it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.61it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.39it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.55it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.48it/s]                                                                                                    1.10 seconds
tensor([  3,  40,   0,  17,   7,   9,   1,   2, 278,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.22it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 29 | Train loss: 0.23824 | Validation loss: 0.19688 | Validation acc: 63.4
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.38it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.49it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.36it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.11it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.36it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.48it/s]                                                                                                    1.10 seconds
tensor([ 10,  36,   1,  20,   7,  10,   1,   0, 267,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.24it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 30 | Train loss: 0.22766 | Validation loss: 0.19747 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.30it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.58it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.87it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.22it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.46it/s]                                                                                                    1.10 seconds
tensor([  7,  50,   1,  20,   5,  12,   2,   2, 258,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.32it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 31 | Train loss: 0.23338 | Validation loss: 0.19894 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.62it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.38it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.28it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.65it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.61it/s]                                                                                                    1.11 seconds
tensor([  0,  66,   2,   1,   7,   7,   2,   2, 271,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.35it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 32 | Train loss: 0.23718 | Validation loss: 0.19777 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.20it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.19it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.27it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.93it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.21it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.41it/s]                                                                                                    1.12 seconds
tensor([  2,  63,   0,   4,  10,   9,   1,   2, 268,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.31it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 33 | Train loss: 0.21723 | Validation loss: 0.19104 | Validation acc: 70.7
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.08it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.13it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.37it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.43it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.05it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.46it/s]                                                                                                    1.11 seconds
tensor([  5,  40,   3,   3,   9,  13,   2,   3, 280,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.68it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 34 | Train loss: 0.22064 | Validation loss: 0.19390 | Validation acc: 73.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.58it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.41it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.49it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.30it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.42it/s]                                                                                                    1.10 seconds
tensor([  2,  56,   1,   2,   7,   5,   2,   5, 272,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.59it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 35 | Train loss: 0.22143 | Validation loss: 0.19214 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.61it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.74it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.91it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.27it/s]                                                                                                    1.10 seconds
tensor([  5,  54,   0,   5,   4,   5,   0,   1, 282,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.45it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 36 | Train loss: 0.22012 | Validation loss: 0.19117 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.36it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.84it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.02it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.44it/s]                                                                                                    1.10 seconds
tensor([  6,  60,   1,   5,   4,   7,   1,   1, 271,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.45it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 37 | Train loss: 0.22509 | Validation loss: 0.20030 | Validation acc: 73.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.21it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.32it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.32it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.45it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.57it/s]                                                                                                    1.10 seconds
tensor([  0,  68,   5,   2,  10,   7,   2,   4, 258,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.39it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 38 | Train loss: 0.21902 | Validation loss: 0.19117 | Validation acc: 65.9
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.14it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.48it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.56it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.15it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.49it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.44it/s]                                                                                                    1.10 seconds
tensor([  3,  60,   1,   0,   9,   2,   5,  11, 264,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.46it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 39 | Train loss: 0.20295 | Validation loss: 0.19497 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.54it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.80it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.58it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.08it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.40it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.61it/s]                                                                                                    1.09 seconds
tensor([  4,  73,   2,   0,  12,   4,   2,   6, 255,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.53it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 40 | Train loss: 0.21713 | Validation loss: 0.18881 | Validation acc: 73.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  5.94it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  8.99it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.46it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.78it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.83it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.07it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.24it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.46it/s]                                                                                                    1.09 seconds
tensor([  5,  70,   1,   1,  12,   3,   5,   4, 252,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.43it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 41 | Train loss: 0.21866 | Validation loss: 0.18832 | Validation acc: 73.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.10it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.09it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.18it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.64it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.40it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.67it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.78it/s]                                                                                                    1.08 seconds
tensor([  3,  86,   2,   1,   7,   2,   3,   7, 246,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.26it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 42 | Train loss: 0.22337 | Validation loss: 0.19095 | Validation acc: 73.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.35it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.33it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.28it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.97it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.38it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.88it/s]                                                                                                    1.09 seconds
tensor([  2,  69,   3,   4,   7,   0,   3,   5, 264,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.44it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 43 | Train loss: 0.20093 | Validation loss: 0.18731 | Validation acc: 78.0
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.10it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.10it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.24it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.62it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.54it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.72it/s]                                                                                                    1.08 seconds
tensor([  3,  64,   3,   4,  10,   1,   3,  13, 256,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.45it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 44 | Train loss: 0.20087 | Validation loss: 0.18429 | Validation acc: 75.6
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.06it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.12it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.03it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.55it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.79it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.17it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.30it/s]                                                                                                    1.11 seconds
tensor([  2,  76,   1,   1,   9,   4,   1,   9, 252,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.23it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 45 | Train loss: 0.19799 | Validation loss: 0.18569 | Validation acc: 70.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.20it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.11it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.79it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.18it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.32it/s]                                                                                                    1.12 seconds
tensor([  6,  63,   0,   0,  10,   6,   1,   5, 262,   6], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.27it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 46 | Train loss: 0.19535 | Validation loss: 0.18425 | Validation acc: 73.2
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.06it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.08it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.12it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.09it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.28it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.31it/s]                                                                                                    1.11 seconds
tensor([  3,  73,   2,   0,   9,   6,   3,   6, 250,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.57it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 47 | Train loss: 0.19152 | Validation loss: 0.18311 | Validation acc: 75.6
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.04it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.10it/s]                                                                                                    tensor([  0,   0,   0,   0,   0,   0,   0,   0, 200,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.28it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.88it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.90it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.27it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.39it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.31it/s]                                                                                                    1.10 seconds
tensor([  2,  67,   2,   2,   9,   4,   2,   4, 260,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.31it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 48 | Train loss: 0.20872 | Validation loss: 0.18374 | Validation acc: 73.2
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.59it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.93it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.52it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.00it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.06it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.12it/s]                                                                                                    1.12 seconds
tensor([  3,  74,   1,   0,  12,   2,   2,   9, 249,   7], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.29it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 49 | Train loss: 0.18078 | Validation loss: 0.18346 | Validation acc: 78.0
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.16it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.73it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.34it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.88it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.21it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.26it/s]                                                                                                    1.12 seconds
tensor([  3,  75,   3,   0,   8,   2,   3,  12, 251,   2], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.34it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0, 82,  0], device='cuda:0')
Epoch 50 | Train loss: 0.20351 | Validation loss: 0.18410 | Validation acc: 75.6
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=100 perturb_router=True topk=1 random_seed=42
Test result | Loss : 64.0 | Score : 53.0
Took 1.29 minutes for training
Took 1.12 seconds per epoch
lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=200 perturb_router=True topk=1 random_seed=42
Formatting dataset:   0%|                                                   | 0/359 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 359/359 [00:00<00:00, 5869.80it/s]
Formatting dataset:   0%|                                                    | 0/41 [00:00<?, ?it/s]Formatting dataset: 100%|█████████████████████████████████████████| 41/41 [00:00<00:00, 6040.27it/s]
Formatting dataset:   0%|                                                   | 0/100 [00:00<?, ?it/s]Formatting dataset: 100%|███████████████████████████████████████| 100/100 [00:00<00:00, 6073.95it/s]
/u/wye/SMoP/scripts/train.py:187: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
prompt_encoder.embedding.weight 153600
prompt_encoder.router.0.weight 15360
trainable params: 168960 || all params: 223051008 || trainable%: 0.07574948955173517
Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]/u/wye/SMoP/scripts/train.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train:   8%|████▊                                                    | 1/12 [00:00<00:10,  1.04it/s]Train:  25%|██████████████▎                                          | 3/12 [00:01<00:02,  3.20it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:01<00:01,  5.11it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:01<00:00,  6.80it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:01<00:00,  7.94it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00,  8.96it/s]                                                                                                    1.91 seconds
tensor([ 12,   1, 120,  84,  25,   0,   3,   7,  28,  19,   8,  10,  13,   8,
          3,   3,   7,   4,   0,   4], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  5.82it/s]                                                                                                    tensor([ 0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 1 | Train loss: 0.27649 | Validation loss: 0.20241 | Validation acc: 65.9
Updating result due to lower validation loss
Test:   0%|                                                                   | 0/4 [00:00<?, ?it/s]Test:  25%|██████████████▊                                            | 1/4 [00:00<00:00,  6.29it/s]Test:  75%|████████████████████████████████████████████▎              | 3/4 [00:00<00:00,  9.31it/s]                                                                                                    Updating result due to higher validation score
Epoch 1 test result: 58.0
tensor([  0,   0, 200,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.04it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.62it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.04it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.27it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.46it/s]                                                                                                    1.09 seconds
tensor([  0,  65, 194,  37,   0,   0,  17,  26,   0,   1,   0,   0,   0,   4,
          0,   0,   0,  12,   0,   3], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.67it/s]                                                                                                    tensor([ 0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 2 | Train loss: 0.97497 | Validation loss: 0.21259 | Validation acc: 56.1
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.42it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.24it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.03it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.23it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.38it/s]                                                                                                    1.11 seconds
tensor([  0, 183, 117,   3,   0,   0,  46,   7,   0,   0,   0,   0,   0,   1,
          0,   0,   0,   2,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.77it/s]                                                                                                    tensor([ 0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 3 | Train loss: 0.27589 | Validation loss: 0.21267 | Validation acc: 58.5
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.46it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.47it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.18it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.69it/s]                                                                                                    1.09 seconds
tensor([  0,   1,  73,   6,   0,   0, 161,   1,   0, 111,   0,   0,   0,   2,
          1,   0,   0,   3,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.58it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 64,  0,  0, 18,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 4 | Train loss: 0.54165 | Validation loss: 0.23028 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.69it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.35it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.48it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.99it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.29it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.26it/s]                                                                                                    1.11 seconds
tensor([  0,   1,  12,   7,   0,   0, 169,   2,   0, 165,   0,   0,   0,   0,
          0,   0,   0,   1,   2,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.71it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 5 | Train loss: 0.26884 | Validation loss: 0.25357 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  5.63it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:01,  8.90it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00,  9.91it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 10.63it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.09it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:01<00:00, 11.50it/s]                                                                                                    1.13 seconds
tensor([  0,   4,  10,  13,   0,   0,  45,   5,   0, 274,   0,   1,   0,   3,
          0,   0,   0,   1,   2,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.65it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 6 | Train loss: 0.28895 | Validation loss: 0.26171 | Validation acc: 48.8
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.60it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.77it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.82it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.30it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.63it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 12.00it/s]                                                                                                    1.07 seconds
tensor([  0,   2,   5,   6,   1,   0,  92,   0,   0, 213,   0,   1,   0,   1,
          0,   0,   0,   2,  36,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.51it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 7 | Train loss: 0.32183 | Validation loss: 0.23188 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.43it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.75it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.75it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.25it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.46it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.89it/s]                                                                                                    1.07 seconds
tensor([  0,   0,  10,   5,   6,   0, 217,   1,   0, 112,   0,   1,   0,   1,
          0,   0,   0,   3,   3,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.69it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 8 | Train loss: 0.27102 | Validation loss: 0.23119 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.82it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.65it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.09it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.44it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.70it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.78it/s]                                                                                                    1.07 seconds
tensor([  0,   0,   6,   3,   6,   0, 166,   1,   0, 171,   0,   3,   0,   2,
          1,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.64it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0,  0,  0,  0, 82,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 9 | Train loss: 0.27216 | Validation loss: 0.22359 | Validation acc: 53.7
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.42it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00,  9.45it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 10.66it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.41it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.66it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.55it/s]                                                                                                    1.09 seconds
tensor([  0,   0,   5,   6,   2,   0, 104,   1,   0, 232,   0,   2,   0,   0,
          0,   0,   0,   3,   3,   1], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.33it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 32,  0,  0, 50,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 10 | Train loss: 0.26139 | Validation loss: 0.21776 | Validation acc: 48.8
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

Train:   0%|                                                                 | 0/12 [00:00<?, ?it/s]Train:   8%|████▊                                                    | 1/12 [00:00<00:01,  6.80it/s]Train:  25%|██████████████▎                                          | 3/12 [00:00<00:00, 10.25it/s]Train:  42%|███████████████████████▊                                 | 5/12 [00:00<00:00, 11.03it/s]Train:  58%|█████████████████████████████████▎                       | 7/12 [00:00<00:00, 11.40it/s]Train:  75%|██████████████████████████████████████████▊              | 9/12 [00:00<00:00, 11.43it/s]Train:  92%|███████████████████████████████████████████████████▎    | 11/12 [00:00<00:00, 11.47it/s]                                                                                                    1.08 seconds
tensor([  0,   1,  42,   1,   0,   0, 187,   0,   0, 126,   0,   2,   0,   0,
          0,   0,   0,   0,   0,   0], device='cuda:0')
Validation:   0%|                                                             | 0/2 [00:00<?, ?it/s]Validation:  50%|██████████████████████████▌                          | 1/2 [00:00<00:00,  6.56it/s]                                                                                                    tensor([ 0,  0,  0,  0,  0,  0, 78,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,
         0,  0], device='cuda:0')
Epoch 11 | Train loss: 0.26704 | Validation loss: 0.21441 | Validation acc: 58.5
Patience of loss-based early stopping has reached 0. No more updates.
Patience of score-based early stopping has reached 0. No more updates.
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')

lr=0.5 batch_size=32 epoch=50 num_virtual_tokens=10 num_virtual_tokens_full=200 perturb_router=True topk=1 random_seed=42
Test result | Loss : 58.0 | Score : 58.0
Took 0.27 minutes for training
Took 1.17 seconds per epoch
